{"Windows.Sigma.Base":{"Name":"Windows.Sigma.Base","Description":"Sigma Model for triaging event logs on Windows.\n\nThis profile includes many Windows EVTX log sources as well as\nmultiple artifact based log sources.\n","Preamble":"name: Windows.Sigma.Base\ndescription: |\n  This artifact builds the basic set of log sources and field\n  mappings used for Sigma on Windows.\n\n  NOTE: This artifact does not include any rules. You can launch it\n  with rules provided to the SigmaRules parameter or call it from\n  another artifact with a set of rules passed to the SigmaRules\n  parameter.\n\n  This artifact was built on {{ .Time }}\n\ntype: CLIENT\n\nparameters:\n  - name: ROOT\n    description: The Event Log Directory we use to read all logs\n    default: C:/Windows/System32/WinEvt/Logs/\n\n  - name: Debug\n    type: bool\n    description: Enable full debug trace\n\n  - name: RuleLevel\n    type: choices\n    default: Critical\n    choices:\n      - \"Critical\"\n      - \"Critical and High\"\n      - \"Critical, High, and Medium\"\n      - \"All\"\n\n  - name: RuleStatus\n    type: choices\n    default: Stable\n    choices:\n      - Stable\n      - Stable and Experimental\n      - Stable and Test\n      - All Rules\n\n  - name: RuleTitleFilter\n    type: regex\n    default: .\n    description: Use this to filter only some rules to match\n\n  - name: RuleExclusions\n    type: csv\n    description: |\n      This table are rules that will be excluded by Title Regex\n    default: |\n      RuleTitleRegex,Reason\n      noisy,All rules marked noisy should be disabled by default.\n\n  - name: DateAfter\n    description: \"search for events after this date. YYYY-MM-DDTmm:hh:ss Z\"\n    type: timestamp\n\n  - name: DateBefore\n    description: \"search for events before this date. YYYY-MM-DDTmm:hh:ss Z\"\n    type: timestamp\n\n  - name: SigmaRules\n    description: If provided we use these rules instead of the built in set.\n\n  - name: NTFS_CACHE_TIME\n    type: int\n    description: How often to flush the NTFS cache. (Default is never).\n    default: \"1000000\"\n","FieldMappings":{"":"x=\u003eserialize(item=x.EventData)","AccessList":"x=\u003ex.EventData.AccessList","AccessMask":"x=\u003ex.EventData.AccessMask","Accesses":"x=\u003ex.EventData.Accesses","AccountDomain":"x=\u003ex.EventData.AccountDomain","AccountName":"x=\u003ex.EventData.AccountName","Account_Name":"x=\u003ex.EventData.Account_Name","Action":"x=\u003ex.EventData.Action","Address":"x=\u003ex.EventData.Address","AllowedToDelegateTo":"x=\u003ex.EventData.AllowedToDelegateTo","AppName":"x=\u003ex.EventData.Data[0]","ApplicationPath":"x=\u003ex.EventData.ApplicationPath","AttributeLDAPDisplayName":"x=\u003ex.EventData.AttributeLDAPDisplayName","AttributeValue":"x=\u003ex.EventData.AttributeValue","AuditPolicyChanges":"x=\u003ex.EventData.AuditPolicyChanges","AuditSourceName":"x=\u003ex.EventData.AuditSourceName","AuthenticationPackageName":"x=\u003ex.EventData.AuthenticationPackageName","CallTrace":"x=\u003ex.EventData.CallTrace","CallerProcessName":"x=\u003ex.EventData.CallerProcessName","Caller_Process_Name":"x=\u003ex.EventData.Caller_Process_Name","CallingProcessName":"x=\u003ex.EventData.CallingProcessName","Caption":"x=\u003ex.EventData.Caption","CategoryName":"x=\u003ex.EventData.`Category Name`","CertThumbprint":"x=\u003ex.EventData.CertThumbprint","Channel":"x=\u003ex.System.Channel","ClassName":"x=\u003ex.EventData.ClassName","ClientAddress":"x=\u003ex.EventData.ClientAddress","ClientName":"x=\u003ex.EventData.ClientName","Client_Address":"x=\u003ex.EventData.Client_Address","CommandLine":"x=\u003ex.EventData.CommandLine || x.CommandLine","Company":"x=\u003ex.EventData.Company","Computer":"x=\u003ex.System.Computer","ComputerName":"x=\u003ex.System.Computer","Contents":"x=\u003ex.EventData.Contents","ContextInfo":"x=\u003ex.EventData.ContextInfo","CreationUtcTime":"x=\u003ex.EventData.CreationUtcTime","CurrentDirectory":"x=\u003ex.EventData.CurrentDirectory","Data":"x=\u003eserialize(item=x.EventData)","Description":"x=\u003ex.EventData.Description","DestAddress":"x=\u003ex.EventData.DestAddress","DestPort":"x=\u003ex.EventData.DestPort","Destination":"x=\u003ex.EventData.Destination","DestinationAddress":"x=\u003ex.EventData.DestinationAddress","DestinationHostname":"x=\u003ex.EventData.DestinationHostname","DestinationIp":"x=\u003ex.EventData.DestinationIp","DestinationIsIpv6":"x=\u003ex.EventData.DestinationIsIpv6","DestinationPort":"x=\u003ex.EventData.DestinationPort","Details":"x=\u003ex.EventData.Details","DetectionSource":"x=\u003ex.EventData.DetectionSource","DetectionUser":"x=\u003ex.EventData.`Detection User`","Device":"x=\u003ex.EventData.Device","DeviceClassName":"x=\u003ex.EventData.DeviceClassName","DeviceDescription":"x=\u003ex.EventData.DeviceDescription","DeviceInstanceID":"x=\u003ex.UserData.InstallDeviceID.DeviceInstanceID","DeviceName":"x=\u003ex.EventData.DeviceName","DomainName":"x=\u003ex.EventData.SubjectDomainName","DriverDescription":"x=\u003ex.UserData.InstallDeviceID.DriverDescription","DriverProvider":"x=\u003ex.UserData.InstallDeviceID.DriverProvider","DvrFmwk2003InstanceId":"x=\u003ex.UserData.UMDFHostDeviceArrivalBegin.InstanceId","DvrFmwkInstanceId":"x=\u003ex.UserData.UMDFHostDeviceRequest.InstanceId","EngineVersion":"x=\u003ex.EventData.EngineVersion","ErrorCode":"x=\u003ex.EventData.ErrorCode","EventData":"x=\u003ex.EventData","EventID":"x=\u003ex.System.EventID.Value","EventType":"x=\u003ex.EventData.EventType","ExecutionProcessID":"x=\u003ex.System.Execution.ProcessID","FailureCode":"x=\u003ex.EventData.FailureCode","Feature_Name":"x=\u003ex.EventData.`Feature Name`","FilePath":"x=\u003ex.EventData.FilePath","FileVersion":"x=\u003ex.EventData.FileVersion","Filename":"x=\u003ex.EventData.Filename","GrandParentCommandLine":"x=\u003ex.EventData.GrandParentCommandLine","GrandParentImage":"x=\u003ex.EventData.GrandParentImage","GrantedAccess":"x=\u003ex.EventData.GrantedAccess","GroupName":"x=\u003ex.EventData.GroupName","GroupSid":"x=\u003ex.EventData.GroupSid","Hash":"x=\u003ex.EventData.Hash","Hashes":"x=\u003ex.EventData.Hashes","HiveName":"x=\u003ex.EventData.HiveName","HostApplication":"x=\u003ex.EventData.HostApplication","HostName":"x=\u003ex.EventData.HostName","HostVersion":"x=\u003ex.EventData.HostVersion","Image":"x=\u003ex.EventData.Image","ImageLoaded":"x=\u003ex.EventData.ImageLoaded","ImagePath":"x=\u003ex.EventData.ImagePath","Imphash":"x=\u003ex.EventData.Hashes","Initiated":"x=\u003ex.EventData.Initiated","InstallStatus":"x=\u003ex.UserData.InstallDeviceID.InstallStatus","InstanceID":"x=\u003ex.UserData.UMDFHostDeviceArrivalBegin.InstanceId","IntegrityLevel":"x=\u003ex.EventData.IntegrityLevel","IpAddress":"x=\u003ex.EventData.IpAddress","IpPort":"x=\u003ex.EventData.IpPort","JobTitle":"x=\u003ex.EventData.name","KeyLength":"x=\u003ex.EventData.KeyLength","Keywords":"x=\u003ex.System.Keywords","LDAPDisplayName":"x=\u003ex.EventData.LDAPDisplayName","LayerRTID":"x=\u003ex.EventData.LayerRTID","Level":"x=\u003ex.System.Level","LocalIP":"x=\u003ex.EventData.LocalIP","LocalPort":"x=\u003ex.EventData.LocalPort","LogFileClearedChannel":"x=\u003ex.UserData.LogFileCleared.Channel","LogFileClearedSubjectUserName":"x=\u003ex.UserData.LogFileCleared.SubjectUserName","LogonID":"x=\u003ex.EventData.LogonID","LogonId":"x=\u003ex.EventData.LogonId","LogonProcessName":"x=\u003ex.EventData.LogonProcessName","LogonType":"x=\u003ex.EventData.LogonType","Logon_Account":"x=\u003ex.EventData.Logon_Account","Logon_Type":"x=\u003ex.EventData.LogonType","MD5":"x=\u003ex.EventData.MD5","MachineName":"x=\u003ex.EventData.MachineName","MandatoryLabel":"x=\u003eget(item=MandatoryLabelLookup, member=x.EventData.MandatoryLabel || \"-\")\n","MemberName":"x=\u003ex.EventData.MemberName","MemberSid":"x=\u003ex.EventData.MemberSid","Message":"x=\u003ex.EventData","ModifyingApplication":"x=\u003ex.EventData.ModifyingApplication","ModuleMD5":"x=\u003ex.EventData.ModuleMD5","ModuleName":"x=\u003ex.EventData.ModuleName","ModulePath":"x=\u003ex.EventData.ModulePath","ModuleSHA1":"x=\u003ex.EventData.ModuleSHA1","ModuleSHA256":"x=\u003ex.EventData.ModuleSHA256","NewName":"x=\u003ex.EventData.NewName","NewProcessId":"x=\u003ex.EventData.NewProcessId","NewProcessName":"x=\u003ex.EventData.NewProcessName","NewTemplateContent":"x=\u003e x.EventData.NewTemplateContent","NewUacValue":"x=\u003ex.EventData.NewUacValue","NewValue":"x=\u003ex.EventData.NewValue","New_Value":"x=\u003ex.EventData.`New Value`","ObjectClass":"x=\u003ex.EventData.ObjectClass","ObjectName":"x=\u003ex.EventData.ObjectName","ObjectServer":"x=\u003ex.EventData.ObjectServer","ObjectType":"x=\u003ex.EventData.ObjectType","ObjectValueName":"x=\u003ex.EventData.ObjectValueName","OldUacValue":"x=\u003ex.EventData.OldUacValue","OperationEssStartedNamespaceName":"x=\u003ex.UserData.Operation_EssStarted.NamespaceName","OperationEssStartedPossibleCause":"x=\u003ex.UserData.Operation_EssStarted.PossibleCause","OperationEssStartedProcessid":"x=\u003ex.UserData.Operation_EssStarted.Processid","OperationEssStartedProvider":"x=\u003ex.UserData.Operation_EssStarted.Provider","OperationEssStartedQuery":"x=\u003ex.UserData.Operation_EssStarted.Query","OperationEssStartedUser":"x=\u003ex.UserData.Operation_EssStarted.User","Origin":"x=\u003ex.EventData.Origin","OriginalFileName":"x=\u003ex.EventData.OriginalFileName","OriginalFilename":"x=\u003ex.EventData.OriginalFileName","PID":"x=\u003ex.EventData.ProcessId","PackageFullName":"x=\u003ex.UserData.PackageFullName","ParentCommandLine":"x=\u003ex.EventData.ParentCommandLine","ParentImage":"x=\u003ex.EventData.ParentImage","ParentMD5":"x=\u003ex.EventData.ParentMD5","ParentProcessId":"x=\u003ex.EventData.ParentProcessId","ParentProcessName":"x=\u003ex.EventData.ParentProcessName","ParentSHA1":"x=\u003ex.EventData.ParentSHA1","ParentSHA256":"x=\u003ex.EventData.ParentSHA256","ParentUser":"x=\u003ex.EventData.ParentUser","PasswordLastSet":"x=\u003ex.EventData.PasswordLastSet","Path":"x=\u003ex.EventData.Path","Payload":"x=\u003ex.EventData.Payload","PipeName":"x=\u003ex.EventData.PipeName","PossibleCause":"x=\u003ex.UserData.PossibleCause","PreAuthType":"x=\u003ex.EventData.PreAuthType","PreviousCreationUtcTime":"x=\u003ex.EventData.PreviousCreationUtcTime","PrivilegeList":"x=\u003ex.EventData.PrivilegeList","ProcessCommandLine":"x=\u003ex.EventData.ProcessCommandLine","ProcessGuid":"x=\u003ex.EventData.ProcessGuid","ProcessId":"x=\u003ex.EventData.ProcessId","ProcessName":"x=\u003ex.EventData.ProcessName","Product":"x=\u003ex.EventData.Product","Properties":"x=\u003ex.EventData.Properties","Protocol":"x=\u003ex.EventData.Protocol","Provider":"x=\u003ex.UserData.Provider","ProviderName":"x=\u003ex.System.Provider.Name","Provider_Name":"x=\u003ex.System.Provider.Name","QNAME":"x=\u003ex.EventData.QNAME","Query":"x=\u003ex.UserData.Query","QueryName":"x=\u003ex.EventData.QueryName","QueryResults":"x=\u003ex.EventData.QueryResults","QueryStatus":"x=\u003ex.EventData.QueryStatus","RelativeTargetName":"x=\u003ex.EventData.RelativeTargetName","RemoteIP":"x=\u003ex.EventData.RemoteIP","RemoteName":"x=\u003ex.EventData.RemoteName","RemotePort":"x=\u003ex.EventData.RemotePort","RuleName":"x=\u003ex.EventData.RuleName","SAMAccountName":"x=\u003ex.EventData.SamAccountName","SHA1":"x=\u003ex.EventData.SHA1","SHA256":"x=\u003ex.EventData.SHA256","SamAccountName":"x=\u003ex.EventData.SamAccountName","ScriptBlockText":"x=\u003ex.EventData.ScriptBlockText","SearchFilter":"x=\u003ex.System.SearchFilter","SecurityUserID":"x=\u003ex.System.Security.UserID","ServerName":"x=\u003ex.System.ServerName","Service":"x=\u003ex.EventData.Service","ServiceFileName":"x=\u003ex.EventData.ServiceFileName","ServiceName":"x=\u003ex.EventData.ServiceName","ServicePrincipalNames":"x=\u003ex.EventData.ServicePrincipalNames","ServiceStartType":"x=\u003ex.EventData.ServiceStartType","ServiceType":"x=\u003ex.EventData.ServiceType","SeverityID":"x=\u003ex.EventData.`Severity ID`","SeverityName":"x=\u003ex.EventData.`Severity Name`","ShareLocalPath":"x=\u003ex.EventData.ShareLocalPath","ShareName":"x=\u003ex.EventData.ShareName","SidHistory":"x=\u003ex.EventData.SidHistory","Signature":"x=\u003ex.EventData.Signature","SignatureStatus":"x=\u003ex.EventData.SignatureStatus","Signed":"x=\u003ex.EventData.Signed","Source":"x=\u003ex.System.Provider_Name","SourceAddress":"x=\u003ex.EventData.SourceAddress","SourceHostname":"x=\u003ex.EventData.SourceHostname","SourceImage":"x=\u003ex.EventData.SourceImage","SourceIp":"x=\u003ex.EventData.SourceIp","SourceIsIpv6":"x=\u003ex.EventData.SourceIsIpv6","SourceNetworkAddress":"x=\u003ex.EventData.SourceNetworkAddress","SourcePort":"x=\u003ex.EventData.SourcePort","Source_Name":"x=\u003ex.EventData.`Source Name`","Source_Network_Address":"x=\u003ex.EventData.Source_Network_Address","Source_WorkStation":"x=\u003ex.EventData.Source_WorkStation","StartAddress":"x=\u003ex.EventData.StartAddress","StartFunction":"x=\u003ex.EventData.StartFunction","StartModule":"x=\u003ex.EventData.StartModule","StartType":"x=\u003ex.EventData.StartType","State":"x=\u003ex.EventData.State","Status":"x=\u003ex.EventData.Status","SubStatus":"x=\u003ex.EventData.SubStatus","SubjectDomainName":"x=\u003ex.EventData.SubjectDomainName","SubjectLogonId":"x=\u003ex.EventData.SubjectLogonId","SubjectUserName":"x=\u003ex.EventData.SubjectUserName","SubjectUserSid":"x=\u003ex.EventData.SubjectUserSid","SysmonVersion":"x=\u003ex.EventData.SysmonVersion","TargetDomainName":"x=\u003ex.EventData.TargetDomainName","TargetFilename":"x=\u003ex.EventData.TargetFilename","TargetImage":"x=\u003ex.EventData.TargetImage","TargetInfo":"x=\u003ex.EventData.TargetInfo","TargetLogonId":"x=\u003ex.EventData.TargetLogonId","TargetObject":"x=\u003ex.EventData.TargetObject","TargetOutboundUserName":"x=\u003ex.EventData.TargetOutboundUserName","TargetProcessAddress":"x=\u003ex.EventData.TargetProcessAddress","TargetServerName":"x=\u003ex.EventData.TargetServerName","TargetSid":"x=\u003ex.EventData.TargetSid","TargetUserName":"x=\u003ex.EventData.TargetUserName","TaskDate":"x=\u003ex.EventData.TaskContent","TaskName":"x=\u003ex.EventData.TaskName","TemplateContent":"x=\u003ex.EventData.TemplateContent","ThreatName":"x=\u003ex.EventData.`Threat Name`","TicketEncryptionType":"x=\u003ex.EventData.TicketEncryptionType","TicketOptions":"x=\u003ex.EventData.TicketOptions","Timestamp":"x=\u003ex.Timestamp","TokenElevationType":"x=\u003eget(item=TokenElevationTypeLookup, member=x.EventData.TokenElevationType || \"-\")","Type":"x=\u003ex.EventData.Type","Url":"x=\u003ex.EventData.url","User":"x=\u003ex.EventData.User","UserDataAddress":"x=\u003ex.UserData.EventXML.Address","UserDataCode":"x=\u003ex.UserData.Operation_StartedOperational.Code","UserDataConsumer":"x=\u003ex.UserData.Operation_ESStoConsumerBinding.CONSUMER","UserDataESS":"x=\u003ex.UserData.Operation_ESStoConsumerBinding.ESS","UserDataHostProcess":"x=\u003ex.UserData.Operation_StartedOperational.HostProcess","UserDataNamespace":"x=\u003ex.UserData.Operation_ESStoConsumerBinding.Namespace","UserDataNamespaceName":"x=\u003ex.UserData.Operation_TemporaryEssStarted.NamespaceName","UserDataParam1":"x=\u003ex.UserData.EventXML.Param1","UserDataParam2":"x=\u003ex.UserData.EventXML.Param2","UserDataParam3":"x=\u003ex.UserData.EventXML.Param3","UserDataPossibleCause":"x=\u003ex.UserData.Operation_ESStoConsumerBinding.PossibleCause","UserDataProcessID":"x=\u003ex.UserData.Operation_StartedOperational.ProcessID","UserDataProcessid":"x=\u003ex.UserData.Operation_TemporaryEssStarted.Processid","UserDataProviderName":"x=\u003ex.UserData.Operation_StartedOperational.ProviderName","UserDataProviderPath":"x=\u003ex.UserData.Operation_StartedOperational.ProviderPath","UserDataQuery":"x=\u003ex.UserData.Operation_TemporaryEssStarted.Query","UserDataSessionID":"x=\u003ex.UserData.EventXML.SessionID","UserDataUser":"x=\u003ex.UserData.EventXML.User","UserName":"x=\u003ex.EventData.UserName","Value":"x=\u003ex.EventData.Value","Version":"x=\u003ex.System.Version","VhdType":"x=\u003ex.EventData.VhdType","WindowsDefenderProcessName":"x=\u003ex.EventData.`Process Name`","Workstation":"x=\u003ex.EventData.Workstation","WorkstationName":"x=\u003ex.EventData.WorkstationName","image":"x=\u003ex.EventData.Image","md5":"x=\u003eparse_string_with_regex(string=x.EventData.Hash || '', regex='MD5=([^,]+)').g1","param1":"x=\u003ex.EventData.param1","param2":"x=\u003ex.EventData.param2","param3":"x=\u003ex.EventData.param3","param4":"x=\u003ex.EventData.param4","param5":"x=\u003ex.EventData.param5","processPath":"x=\u003ex.EventData.processPath","query":"x=\u003ex.EventData.Query","service":"x=\u003ex.EventData.Service","sha1":"x=\u003ex.EventData.Hashes","sha256":"x=\u003eparse_string_with_regex(string=x.EventData.Hash || '', regex='SHA256=([^,]+)').g1"},"DefaultDetails":{"Query":"x=\u003eget(item=DefaultDetails,\n       member=format(format=\"%v/%v\",\n          args=[x.System.Provider.Name, x.System.EventID.Value])\n      ) || x.Message || x.UserData || x.EventData\n","Lookup":{"MSExchange CmdletLogs/6":"Data: %Data%","Microsoft-Windows-Bits-Client/3":"JobTitle: %jobTitle% ¦ JobID: %jobId% ¦ JobOwner: %jobOwner% ¦ Proc: %processPath% ¦ PID: %ProcessId%","Microsoft-Windows-DNS-Server-Service/150":"DLL: %param1%","Microsoft-Windows-DNS-Server-Service/770":"Path: %param1% ¦ SrcComp: %param2%","Microsoft-Windows-DriverFrameworks-UserMode/2003":"Device: %DvrFmwk2003InstanceId%","Microsoft-Windows-DriverFrameworks-UserMode/2100":"Device: %DvrFmwkInstanceId%","Microsoft-Windows-DriverFrameworks-UserMode/2102":"Device: %DvrFmwkInstanceId%","Microsoft-Windows-Ntfs/98":"Drive: %DriveName% ¦ Device: %DeviceName%","Microsoft-Windows-PowerShell/4103":"Payload: %Payload%","Microsoft-Windows-PowerShell/4104":"ScriptBlock: %ScriptBlockText%","Microsoft-Windows-PrintService/300":"PrinterCreated: %PrinterCreated%","Microsoft-Windows-PrintService/301":"DeletedPrinter: %Param1%","Microsoft-Windows-PrintService/302":"PrinterDeletionPending: %PrinterDeletionPending%","Microsoft-Windows-PrintService/354":"Printer: %Param1% ¦ DLL: %Param2% ¦ Error: %Param3%","Microsoft-Windows-PrintService/823":"OldDefaultPrinter: %OldDefaultPrinter% ¦ NewDefaultPrinter: %NewDefaultPrinter% ¦ Status: %Status% ¦ Module: %Module%","Microsoft-Windows-PrintService/848":"PrinterName: %PrinterName% ¦ ShareName: %ShareName%","Microsoft-Windows-PrintService/849":"PrinterName: %PrinterName% ¦ ShareName: %ShareName%","Microsoft-Windows-Security-Auditing/1102":"User: %LogFileClearedSubjectUserName%","Microsoft-Windows-Security-Auditing/4616":"PrevTime: %PreviousTime% ¦ NewTime: %NewTime% ¦ User: %SubjectUserName% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4624":"Type: %LogonType% ¦ TgtUser: %TargetUserName% ¦ SrcComp: %WorkstationName% ¦ SrcIP: %IpAddress% ¦ LID: %TargetLogonId%","Microsoft-Windows-Security-Auditing/4625":"Type: %LogonType% ¦ TgtUser: %TargetUserName% ¦ SrcComp: %WorkstationName% ¦ SrcIP: %IpAddress% ¦ AuthPkg: %AuthenticationPackageName% ¦ Proc: %ProcessName%","Microsoft-Windows-Security-Auditing/4648":"TgtUser: %TargetUserName% ¦ SrcUser: %SubjectUserName% ¦ SrcIP: %IpAddress% ¦ Proc: %ProcessName% ¦ TgtSvr: %TargetInfo%","Microsoft-Windows-Security-Auditing/4656":"User: %SubjectUserName% ¦ ObjSvr: %ObjectServer% ¦ ObjName: %ObjectName% ¦ ObjType: %ObjectType% ¦ AccessReason: %AccessReason% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ HID: %HandleId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4661":"User: %SubjectUserName% ¦ ObjSvr: %ObjectServer% ¦ ObjType: %ObjectType% ¦ ObjName: %ObjectName% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4662":"User: %SubjectUserName% ¦ ObjSvr: %ObjectServer% ¦ ObjName: %ObjectName% ¦ OpType: %OperationType% ¦ HID: %HandleId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4663":"User: %SubjectUserName% ¦ ObjSvr: %ObjectServer% ¦ ObjName: %ObjectName% ¦ ObjType: %ObjectType% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ HID: %HandleId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4672":"TgtUser: %SubjectUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4673":"Proc: %ProcessName% ¦ User: %SubjectUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4674":"Svc: %ObjectName% ¦ User: %SubjectUserName% ¦ AccessMask: %AccessMask% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4688":"Cmdline: %CommandLine% ¦ Proc: %NewProcessName% ¦ PID: %NewProcessId% ¦ User: %SubjectUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4692":"User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ Domain: %SubjectDomainName% ¦ MasterKeyId: %MasterKeyId% ¦ RecoveryServer: %RecoveryServer% ¦ RecoveryKeyId: %RecoveryKeyId% ¦ FailureReason: %FailureReason%","Microsoft-Windows-Security-Auditing/4697":"Svc: %ServiceName% ¦ Path: %ServiceFileName% ¦ User: %SubjectUserName% ¦ SvcAcct: %ServiceAccount% ¦ SvcType: %ServiceType% ¦ SvcStartType: %ServiceStartType% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4698":"Name: %TaskName% ¦ Content: %TaskContent% ¦ User: %SubjectUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4699":"Name: %TaskName% ¦ User: %SubjectUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4719":"User: %SubjectUserName% ¦ AuditPolicyChanges: %AuditPolicyChanges% ¦ CategoryId: %CategoryId% ¦ SubcategoryGuid: %SubcategoryGuid% ¦ SubcategoryId: %SubcategoryId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4720":"TgtUser: %TargetUserName% ¦ TgtSID: %TargetSid%","Microsoft-Windows-Security-Auditing/4728":"SrcSID: %MemberSid% ¦ TgtGrp: %TargetUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4732":"SrcSID: %MemberSid% ¦ TgtGrp: %TargetUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4738":"User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ TgtUser: %TargetUserName% ¦ TgtSID: %TargetSid% ¦ Domain: %SubjectDomainName% ¦ TgtDomain: %TargetDomainName% ¦ SamUser: %SamAccountName% ¦ DisplayName: %DisplayName% ¦ UAC: %UserAccountControl% ¦ OldUAC: %OldUacValue% ¦ NewUAC: %NewUacValue% ¦ AcctExpires: %AccountExpires% ¦ AllowedToDelegateTo: %AllowedToDelegateTo% ¦ HomeDir: %HomeDirectory% ¦ HomePath: %HomePath% ¦ LogonHours: %LogonHours% ¦  PwLastSet: %PasswordLastSet% ¦ PrimaryGrpID: %PrimaryGroupId% ¦ PrivList: %PrivilegeList% ¦ ProfilePath: %ProfilePath% ¦ ScriptPath: %ScriptPath% ¦ SidHistory: %SidHistory% ¦ UserParams: %UserParameters% ¦ UPN: %UserPrincipalName% ¦ SrcComp: %UserWorkstations% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4742":"SPN: %ServicePrincipalNames% ¦ User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ TgtUser: %TargetUserName% ¦ TgtSID: %TargetSid% ¦ Domain: %SubjectDomainName% ¦ TgtDomain: %TargetDomainName% ¦ SamUser: %SamAccountName% ¦ DisplayName: %DisplayName% ¦ UAC: %UserAccountControl% ¦ OldUAC: %OldUacValue% ¦ NewUAC: %NewUacValue% ¦ AcctExpires: %AccountExpires% ¦ AllowedToDelegateTo: %AllowedToDelegateTo% ¦ HomeDir: %HomeDirectory% ¦ HomePath: %HomePath% ¦ LogonHours: %LogonHours% ¦  PwLastSet: %PasswordLastSet% ¦ PrimaryGrpID: %PrimaryGroupId% ¦ PrivList: %PrivilegeList% ¦ ProfilePath: %ProfilePath% ¦ ScriptPath: %ScriptPath% ¦ SidHistory: %SidHistory% ¦ UserParams: %UserParameters% ¦ UPN: %UserPrincipalName% ¦ SrcComp: %UserWorkstations% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4765":"User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ SrcUser: %SourceUserName% ¦ SrcSID: %SourceSid% ¦ TgtUser: %TargetUserName% ¦ TgtSID: %TargetSid% ¦ Domain: %SubjectDomainName% ¦ TgtDomain: %TargetDomainName% ¦ PrivList: %PrivilegeList% ¦ SidList: %SidList% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4768":"TgtUser: %TargetUserName% ¦ Svc: %ServiceName% ¦ SrcIP: %IpAddress% ¦ Status: %Status% ¦ PreAuthType: %PreAuthType%","Microsoft-Windows-Security-Auditing/4769":"TgtUser: %TargetUserName% ¦ Svc: %ServiceName% ¦ SrcIP: %IpAddress% ¦ Status: %Status%","Microsoft-Windows-Security-Auditing/4776":"TgtUser: %TargetUserName% ¦ SrcComp: %Workstation% ¦ Status: %Status%","Microsoft-Windows-Security-Auditing/4778":"SrcUser: %AccountName% ¦ Domain: %AccountDomain% ¦ SrcIP: %ClientAddress% ¦ SrcComp: %ClientName% ¦ LID: %LogonID%","Microsoft-Windows-Security-Auditing/4779":"SrcUser: %AccountName% ¦ Domain: %AccountDomain% ¦ SrcIP: %ClientAddress% ¦ SrcComp: %ClientName% ¦ LID: %LogonID%","Microsoft-Windows-Security-Auditing/4781":"OldTgtUser: %OldTargetUserName% ¦ NewTgtUser: %NewTargetUserName% ¦ TgtSID: %TargetSid% ¦ User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ Domain: %SubjectDomainName% ¦ TgtDomain: %TargetDomainName% ¦ PrivList: %PrivilegeList% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4794":"User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ Domain: %SubjectDomainName% ¦ Status: %Status% ¦ SrcComp: %Workstation% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4825":"Domain: %AccountDomain% ¦ User: %AccountName% ¦ SrcIP: %ClientAddress% ¦ LID: %LogonID%","Microsoft-Windows-Security-Auditing/4904":"AuditSrcName: %AuditSourceName% ¦ EventSrcID: %EventSourceId% ¦ User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ Domain: %SubjectDomainName% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4905":"AuditSrcName: %AuditSourceName% ¦ User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/5038":"Path: %param1%","Microsoft-Windows-Security-Auditing/5136":"User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ ObjDN: %ObjectDN% ¦ AttrLDAPName: %AttributeLDAPDisplayName% ¦ OpType: %OperationType% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/5140":"SrcUser: %SubjectUserName% ¦ ShareName: %ShareName% ¦ SharePath: %ShareLocalPath% ¦ SrcIP: %IpAddress% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/5142":"User: %SubjectUserName% ¦ ShareName: %ShareName% ¦ ShareLocalPath: %ShareLocalPath% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/5145":"SrcUser: %SubjectUserName% ¦ ShareName: %ShareName% ¦ SharePath: %ShareLocalPath% ¦ Path: %RelativeTargetName% ¦ SrcIP: %IpAddress% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/5156":"Proc: %Application% ¦ SrcIP: %SourceAddress% ¦ SrcPort: %SourcePort% ¦ TgtIP: %DestAddress% ¦ TgtPort: %DestPort% ¦ Protocol: %Protocol% ¦ TgtMachineID: %RemoteMachineID% ¦ TgtSID: %RemoteUserID% ¦ PID: %ProcessID%","Microsoft-Windows-Security-Auditing/5157":"Proc: %Application% ¦ SrcIP: %SourceAddress% ¦ SrcPort: %SourcePort% ¦ TgtIP: %DestAddress% ¦ TgtPort: %DestPort% ¦ Protocol: %Protocol% ¦ TgtMachineID: %RemoteMachineID% ¦ TgtSID: %RemoteUserID% ¦ PID: %ProcessID%","Microsoft-Windows-Security-Auditing/5379":"PID: %ClientProcessId% ¦ SrcUser: %SubjectUserName% ¦ Tgt: %TargetName% ¦ CredsReturned: %CountOfCredentialsReturned% ¦ ReturnCode: %ReturnCode% ¦ LID: %SubjectLogonId% ¦ SrcSID: %SubjectUserSid%","Microsoft-Windows-Security-Auditing/6281":"Path: %param1%","Microsoft-Windows-Security-Auditing/6416":"DeviceDescrip: %DeviceDescription% ¦ DeviceID: %DeviceId% ¦ LocInfo: %LocationInformation% ¦ CompatibleIDs: %CompatibleIds% ¦ User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Sysmon/1":"Cmdline: %CommandLine% ¦ Proc: %Image% ¦ User: %User% ¦ ParentCmdline: %ParentCommandLine% ¦ LID: %LogonId% ¦ LGUID: %LogonGuid% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid% ¦ ParentPID: %ParentProcessId% ¦ ParentPGUID: %ParentProcessGuid% ¦ Description: %Description% ¦ Product: %Product% ¦ Company: %Company% ¦ Hashes: %Hashes%","Microsoft-Windows-Sysmon/10":"SrcProc: %SourceImage% ¦ TgtProc: %TargetImage% ¦ SrcUser: %SourceUser% ¦ TgtUser: %TargetUser% ¦ Access: %GrantedAccess% ¦ SrcPID: %SourceProcessId% ¦ SrcPGUID: %SourceProcessGUID% ¦ TgtPID: %TargetProcessId% ¦ TgtPGUID: %TargetProcessGUID%","Microsoft-Windows-Sysmon/11":"Path: %TargetFilename% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/12":"EventType: %EventType% ¦ TgtObj: %TargetObject% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/13":"EventType: %EventType% ¦ TgtObj: %TargetObject%: %Details% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/14":"EventType: %EventType% ¦ TgtObj: %TargetObject%: %Details% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/15":"Path: %TargetFilename% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid% ¦ Hash: %Hash%","Microsoft-Windows-Sysmon/16":"Config: %Configuration%","Microsoft-Windows-Sysmon/17":"Pipe: %PipeName% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/18":"Pipe: %PipeName% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/19":"Op: %Operation% ¦ Namespace: %EventNamespace% ¦ Name: %Name% ¦ Query: %query% ¦ User: %User%","Microsoft-Windows-Sysmon/2":"Path: %TargetFilename% ¦ Proc: %Image% ¦ User: %User% ¦ CreationTime: %CreationUtcTime% ¦ PreviousTime: %PreviousCreationUtcTime% ¦ PID: %PID% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/20":"Op: %Operation% ¦ Type: %Type% ¦ Name: %Name% ¦ Tgt: %Destination% ¦ User: %User%","Microsoft-Windows-Sysmon/21":"Op: %Operation% ¦ Consumer: %Consumer% ¦ Filter: %Filter%","Microsoft-Windows-Sysmon/22":"Query: %QueryName% ¦ Result: %QueryResults% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/23":"Path: %TargetFilename% ¦ Proc: %Image% ¦ User: %User% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/24":"Proc: %Image% ¦ User: %User% ¦ CliInfo: %ClientInfo% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/25":"Proc: %Image% ¦ Type: %Type% ¦ User: %User% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/255":"ID: %ID% ¦ Description: %Description%","Microsoft-Windows-Sysmon/26":"Path: %TargetFilename% ¦ Proc: %Image% ¦ User: %User% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/3":"Initiated: %Initiated% ¦ Proto: %Protocol% ¦ SrcIP: %SourceIp% ¦ SrcPort: %SourcePort% ¦ SrcHost: %SourceHostname% ¦ TgtIP: %DestinationIp% ¦ TgtPort: %DestinationPort% ¦ TgtHost: %DestinationHostname% ¦ User: %User% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/4":"State: %State% ¦ SysmonVer: %SysmonVersion% ¦ SchemaVer: %SchemaVersion%","Microsoft-Windows-Sysmon/5":"Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/6":"Path: %ImageLoaded% ¦ Sig: %Signature% ¦ Signed: %Signed% ¦ SigStatus: %SignatureStatus% ¦ Hashes: %Hashes%","Microsoft-Windows-Sysmon/7":"Image: %ImageLoaded% ¦ Proc: %Image% ¦ Description: %Description% ¦ Product: %Product% ¦ Company: %Company% ¦ Signed: %Signed% ¦ Sig: %SignatureStatus% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid% ¦ Hash: %Hashes% ¦ OrigFilename: %OriginalFilename%","Microsoft-Windows-Sysmon/8":"SrcProc: %SourceImage% ¦ TgtProc: %TargetImage% ¦ SrcPID: %SourceProcessId% ¦ SrcPGUID: %SourceProcessGuid% ¦ TgtPID: %TargetProcessId% ¦ TgtPGUID: %TargetProcessGuid%","Microsoft-Windows-Sysmon/9":"Proc: %Image% ¦ Device: %Device% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-WMI-Activity/5859":"Namespace: %OperationEssStartedNamespaceName% ¦ Query: %UserDataQuery% ¦ SID: %OperationEssStartedUser% ¦ PID: %OperationEssStartedProcessid% ¦ Provider: %OperationEssStartedProvider% ¦ PossibleCause: %OperationEssStartedPossibleCause%","Microsoft-Windows-Windows Defender/1013":"Time: %Timestamp% ¦ User: %User%","Microsoft-Windows-Windows Defender/1116":"Threat: %ThreatName% ¦ Severity: %SeverityName% ¦ Type: %CategoryName% ¦ User: %DetectionUser% ¦ Path: %Path% ¦ Proc: %WindowsDefenderProcessName%","Microsoft-Windows-Windows Firewall With Advanced Security/2003":"Profile: %Profiles% ¦ Type: %SettingType% ¦ Value: %SettingValueString% ¦ User: %ModifyingUser% ¦ App: %ModifyingApplication%","Microsoft-Windows-Windows Firewall With Advanced Security/2004":"RuleName: %RuleName% ¦ App: %ApplicationPath% ¦ ModifyingApp: %ModifyingApplication% ¦ User: %ModifyingUser% ¦ Svc: %ServiceName% ¦ Protocol: %Protocol% ¦ LocalAddr: %LocalAddresses% ¦ LocalPort: %LocalPorts% ¦ RemoteAddr: %RemoteAddresses% ¦ RemotePort: %RemotePorts% ¦ Action: %Action%","MsiInstaller/1034":"Product: %Data[1]% ¦ Ver: %Data[2]% ¦ Vendor: %Data[5]% ¦ Status: %Data[4]%","MsiInstaller/11724":"Product: %Data[1]%","PowerShellCore/4103":"Payload: %Payload%","PowerShellCore/4104":"ScriptBlock: %ScriptBlockText%","Service Control Manager/7031":"Svc: %param1% ¦ CrashCount: %param2% ¦ Action: %param5%","Service Control Manager/7045":"Svc: %ServiceName% ¦ Path: %ImagePath% ¦ Acct: %AccountName% ¦ StartType: %StartType%"}},"Sources":{"*/windows/application":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Application.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Application"],"fields":["Channel","EventID"],"description":"This Log Source generates events from the Application Channel.\n\nThese are  usually stored in the file `C:\\Windows\\System32\\WinEvt\\Logs\\Application.evtx`\n\nThe channel stores a wide variety of system events from multiple\nservices.\n"},"*/windows/applocker":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=[\n  ROOT + \"/Microsoft-Windows-AppLocker%4MSI and Script.evtx\",\n  ROOT + \"/Microsoft-Windows-AppLocker%4EXE and DLL.evtx\",\n  ROOT + \"/Microsoft-Windows-AppLocker%4Packaged app-Deployment.evtx\",\n  ROOT + \"/Microsoft-Windows-AppLocker%4Packaged app-Execution.evtx\",\n])\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-AppLocker/MSI and Script","Microsoft-Windows-AppLocker/EXE and DLL","Microsoft-Windows-AppLocker/Packaged app-Deployment","Microsoft-Windows-AppLocker/Packaged app-Execution"],"fields":["Channel","EventID"],"description":"This Log Source generates combined events from the Windows `AppLocker service`.\n\nEvents are usually stored in the files:\n  * `C:\\Windows\\System32\\WinEvt\\Logs\\Microsoft-Windows-AppLocker%4MSI and Script.evtx`\n  * `C:\\Windows\\System32\\WinEvt\\Logs\\Microsoft-Windows-AppLocker%4EXE and DLL.evtx`\n  * `C:\\Windows\\System32\\WinEvt\\Logs\\Microsoft-Windows-AppLocker%4Packaged app-Deployment.evtx`\n  * `C:\\Windows\\System32\\WinEvt\\Logs\\Microsoft-Windows-AppLocker%4Packaged app-Execution.evtx`\n"},"*/windows/appmodel-runtime":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-AppModel-Runtime%4Admin.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-AppModel-Runtime/Admin"],"fields":["Channel","EventID"],"description":"This Log Source generates combined events from the Windows `AppModel Runtime`.\n\nEvents are usually stored in the files:\n  * `C:\\Windows\\System32\\WinEvt\\Logs\\Microsoft-Windows-AppModel-Runtime%4Admin.evtx`\n"},"*/windows/appxdeployment-server":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-AppxPackaging%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-AppxPackaging/Operational"],"fields":["Channel","EventID"]},"*/windows/appxpackaging-om":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-AppxPackaging%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-AppxPackaging/Operational"],"fields":["Channel","EventID"]},"*/windows/bits-client":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-Bits-Client%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-Bits-Client/Operational"],"fields":["Channel","EventID","processPath","RemoteName"],"description":"This Log Source generates combined events from the Windows Bits Client service.\n\nEvents are usually stored in the files:\n  * `C:\\Windows\\System32\\WinEvt\\Logs\\Microsoft-Windows-Bits-Client%4Operational.evtx`\n\nThe BITS service is used to download files and it is often misused by threat actors to download malicious payloads.\n","samples":[{"name":"EventID 3 - New Job Creation","json":"config/samples/bits_client.json"}]},"*/windows/capi2":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-CAPI2/Operational\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-CAPI2/Operational"],"fields":["Channel","EventID"]},"*/windows/certificateservicesclient-lifecycle-system":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-CertificateServicesClient-Lifecycle-System/Operational\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-CertificateServicesClient-Lifecycle-System/Operational"],"fields":["Channel","EventID"]},"*/windows/codeintegrity-operational":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-CodeIntegrity%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-CodeIntegrity/Operational"],"fields":["Channel","EventID"]},"*/windows/diagnosis-scripted":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-Diagnosis-Scripted%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-Diagnosis-Scripted/Operational"],"fields":["Channel","EventID"]},"*/windows/dns-client":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-DNS Client Events%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-DNS Client Events/Operational"],"fields":["Channel","EventID"]},"*/windows/dns-server":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/DNS Server.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["DNS Server"],"fields":["Channel","EventID"]},"*/windows/dns-server-analytic":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-DNS-Server%4Analytical.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-DNS-Server/Analytical"],"fields":["Channel","EventID"]},"*/windows/driver-framework":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-DriverFrameworks-UserMode%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-DriverFrameworks-UserMode/Operational"],"fields":["Channel","EventID"]},"*/windows/firewall-as":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-Windows Firewall With Advanced Security%4Firewall.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-Windows Firewall With Advanced Security/Firewall"],"fields":["Channel","EventID"]},"*/windows/ldap_debug":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-LDAP-Client%4Debug.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-LDAP-Client/Debug"],"fields":["Channel","EventID"]},"*/windows/lsa-server":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-LSA%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-LSA/Operational"],"fields":["Channel","EventID"]},"*/windows/microsoft-servicebus-client":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-ServiceBus-Client.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-ServiceBus-Client"],"fields":["Channel","EventID"]},"*/windows/msexchange-management":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/MSExchange Management.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["MSExchange Management"],"fields":["Channel","EventID"]},"*/windows/ntlm":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-NTLM%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-NTLM/Operational"],"fields":["Channel","EventID"]},"*/windows/openssh":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/OpenSSH%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["OpenSSH/Operational"],"fields":["Channel","EventID"]},"*/windows/powershell":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=[\n   ROOT + \"/Microsoft-Windows-PowerShell%4Operational.evtx\",\n   ROOT + \"/PowerShellCore%4Operational.evtx\",\n])\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-PowerShell/Operational","PowerShellCore/Operational"],"fields":["Channel","EventID","MessageNumber","MessageTotal","ScriptBlockText","ScriptBlockId","ContextInfo","UserData","Payload"]},"*/windows/powershell-classic":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *, EventData + dict(\n   Data=EventData.Data[2],\n   HostApplication=parse_string_with_regex(\n     regex=\"HostApplication=([^\\\\r\\\\n]+)\",\n     string=EventData.Data[2]).g1) AS EventData\nFROM parse_evtx(filename=ROOT + \"/Windows PowerShell.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Windows PowerShell"],"fields":["Channel","EventID"]},"*/windows/printservice-admin":{},"*/windows/printservice-operational":{},"*/windows/security":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Security.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Security"],"fields":["Channel","EventID"]},"*/windows/security-mitigations":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-Security-Mitigations.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-Security-Mitigations"]},"*/windows/shell-core":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-Shell-Core%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-Shell-Core/Operational"],"fields":["Channel","EventID"]},"*/windows/smbclient-connectivity":{},"*/windows/smbclient-security":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-SmbClient%4Security.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-SmbClient/Security"],"fields":["Channel","EventID"]},"*/windows/sysmon":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-Sysmon%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-Sysmon/Operational"],"fields":["Channel","EventID","Provider_Name","Imphash","sha1","sha256","md5","ImagePath","TargetParentImage"]},"*/windows/system":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/System.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["System"],"fields":["Channel","EventID","Caption"]},"*/windows/taskscheduler":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-TaskScheduler%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-TaskScheduler/Operational"],"fields":["Channel","EventID"]},"*/windows/terminalservices-localsessionmanager":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-TerminalServices-LocalSessionManager/Operational"],"fields":["Channel","EventID","Address"]},"*/windows/vhdmp":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-VHDMP%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-VHDMP/Operational"],"fields":["EventID","VhdType","Channel"]},"*/windows/windefend":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-Windows Defender%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-Windows Defender/Operational"],"fields":["Channel","EventID","SeverityID","ThreatName"]},"*/windows/wmi":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-WMI-Activity%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-WMI-Activity/Operational"],"fields":["Channel","EventID"]},"process_creation/windows/*":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=[\n   ROOT + \"/Microsoft-Windows-Sysmon%4Operational.evtx\",\n   ROOT + \"/Security.evtx\"\n])\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n  AND System.EventID.Value = 1 OR System.EventID.Value = 4688\n","fields":["Channel","EventID"]},"ps_classic_provider_start/windows/*":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Windows PowerShell.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime AND System.EventID.Value = 600\n","fields":["Channel","EventID"]},"ps_classic_start/windows/*":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Windows PowerShell.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime AND System.EventID.Value = 400\n","fields":["Channel","EventID"]},"ps_module/windows/*":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=[\n   ROOT + \"/Microsoft-Windows-PowerShell%4Operational.evtx\",\n   ROOT + \"/PowerShellCore%4Operational.evtx\"\n])\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime AND System.EventID.Value = 4103\n","fields":["Channel","EventID"]},"ps_script/windows/*":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=[\n   ROOT + \"/Microsoft-Windows-PowerShell%4Operational.evtx\",\n   ROOT + \"/PowerShellCore%4Operational.evtx\"\n])\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime AND System.EventID.Value = 4104\n","fields":["Channel","EventID"]},"registry_add/windows/*":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=[\n   ROOT + \"/Microsoft-Windows-Sysmon%4Operational.evtx\",\n   ROOT + \"/Security.evtx\"\n])\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime AND System.EventID.Value = 12 OR System.EventID.Value = 4657\n","fields":["Channel","EventID"]},"registry_event/windows/*":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=[\n   ROOT + \"/Microsoft-Windows-Sysmon%4Operational.evtx\",\n   ROOT + \"/Security.evtx\"\n])\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n  AND System.EventID.Value IN (12, 13, 14) OR System.EventID.Value = 4657\n","fields":["Channel","EventID"]},"registry_set/windows/*":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=[\n   ROOT + \"/Microsoft-Windows-Sysmon%4Operational.evtx\",\n   ROOT + \"/Security.evtx\"\n])\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n  AND System.EventID.Value = 13 OR System.EventID.Value = 4657\n","fields":["Channel","EventID"]},"antivirus/windows/windefend":{"query":"SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp, *\nFROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-Windows Defender%4Operational.evtx\")\nWHERE Timestamp \u003e= DateAfterTime AND Timestamp \u003c= DateBeforeTime\n","channel":["Microsoft-Windows-Windows Defender/Operational"],"fields":["Channel","EventID"]},"vql/windows/*":{"query":"SELECT dict(\n    Computer=Hostname,\n    Channel=\"VQL Evaluation\",\n    TimeCreated=dict(SystemTime=now())\n  ) AS System,\n  dict() AS EventData\nFROM scope()\n"},"*/windows/schtasks":{"query":"SELECT dict(Computer=Hostname, Channel='Velociraptor') AS System, *\nFROM Artifact.Windows.System.TaskScheduler()\n","fields":["Arguments","Comhandler","CommandLine","Image","UserId"],"description":"Enumerates All Scheduled tasks"},"*/windows/services":{"query":"SELECT dict(Computer=Hostname, Channel='Velociraptor') AS System, *,\n    PathName AS CommandLine, ServiceDll AS Image,\n    UserAccount AS User\nFROM Artifact.Windows.System.Services()\n","fields":["CommandLine","Created","DisplayName","ExitCode","Image","Name","ServiceType","StartMode","State","Status","User"]},"persistence/windows/services":{"query":"SELECT dict(Computer=Hostname, Channel='Velociraptor') AS System, *,\n    PathName AS CommandLine, ServiceDll AS Image,\n    UserAccount AS User\nFROM Artifact.Windows.System.Services()\n","fields":["CommandLine","Created","DisplayName","ExitCode","Image","Name","ServiceType","StartMode","State","Status","User"]},"process_creation/windows/execution":{"query":"SELECT dict(Computer=Hostname, Channel='Velociraptor') AS System, *\nFROM Artifact.Windows.Analysis.EvidenceOfExecution()\n","fields":["LastExecution","Name","NumberOfExecutions","User"]},"webserver/windows/*":{"query":"SELECT dict(Computer=Hostname, Channel='Velociraptor') AS System, *\nFROM Artifact.Windows.Applications.IISLogs()\n"},"process_creation/windows/pslist":{"query":"SELECT CreateTime AS Timestamp,\n       dict(Computer=Hostname, Channel='Velociraptor') AS System,\n       dict(CreateTime=CreateTime, CommandLine= CommandLine,\n            Image=Exe, MD5=H.MD5, SHA256=H.SHA256, SHA1=H.SHA1,\n            ParentCommandLine=P.CommandLine,\n            ParentImage=P.Exe,\n            ParentMD5=PH.MD5,\n            ParentSHA1=PH.SHA1,\n            ParentSHA256=PH.SHA256,\n            GrandParentCommandLine=GP.CommandLine,\n            GrandParentImage=GP.Exe,\n            User=Username\n       ) AS EventData\nFROM foreach(row={\n      SELECT StartTime AS CreateTime,\n          Pid, CommandLine, Exe,\n          process_tracker_get(id=Ppid).Data AS P,\n          if(condition=process_tracker_get(id=Ppid).Data.Exe,\n             then=hash(path=process_tracker_get(id=Ppid).Data.Exe)) AS PH,\n          process_tracker_get(id=process_tracker_get(id=Ppid).ParentId).Data AS GP,\n          if(condition=Exe, then=hash(path=Exe)) AS H,\n          Username\n      FROM process_tracker_pslist()\n})\n","fields":["CommandLine","GrandParentCommandLine","GrandParentImage","Image","MD5","md5","ParentCommandLine","ParentImage","ParentMD5","SHA1","sha1","SHA256","sha256","User"]},"image_load/windows/pslist":{"query":"SELECT CreateTime AS Timestamp,\n       dict(Computer=Hostname, Channel='Velociraptor') AS System,\n       dict(CommandLine=CommandLine,\n            Image=Exe,\n            User=Username,\n            MD5=H.MD5,\n            SHA1=H.SHA1,\n            SHA256=H.SHA256,\n            ModuleName=ModuleName,\n            ModulePath=ModulePath,\n            ModuleMD5=MH.MD5,\n            ModuleSHA1=MH.SHA1,\n            ModuleSHA256=MH.SHA256,\n            GrandParentImage=GP.Exe,\n            GrandParentCommandLine=GP.CommandLine,\n            ParentCommandLine=P.CommandLine,\n            ParentImage=P.Exe,\n            ParentMD5=PH.MD5,\n            ParentSHA1=PH.SHA1,\n            ParentSHA256=PH.SHA256) AS EventData\nFROM foreach(\n  row={\n      SELECT StartTime AS CreateTime,\n          Pid, CommandLine, Exe,\n          process_tracker_get(id=Ppid).Data AS P,\n          if(condition=Exe, then=hash(path=Exe)) AS H,\n          Username\n      FROM process_tracker_pslist()},\n  query={\n      SELECT CreateTime, Exe, CommandLine, P, H, Username,\n          if(condition=P.Exe, then=hash(path=P.Exe), else=P.Exe) AS PH,\n          ModuleName, ExePath AS ModulePath,\n          if(condition=ExePath, then=hash(path=ExePath), else=ExePath) AS MH,\n          process_tracker_get(id=P.Ppid).Data AS GP\n      FROM modules(pid=int(int=Pid))}\n)\n","fields":["CommandLine","GrandParentCommandLine","GrandParentImage","Image","ModuleMD5","ModuleName","ModulePath","ModuleSHA1","ModuleSHA256","ParentCommandLine","ParentImage","ParentMD5","ParentSHA1","ParentSHA256","MD5","SHA1","SHA256","User"]},"network_connection/windows/netstat":{"query":"SELECT pt.CreateTime AS Timestamp,\n       dict(Computer=Hostname, Channel='Velociraptor') AS System,\n       dict(CommandLine=CommandLine,\n            Status= Status,\n            Image=Image,\n            LocalIP= LocalIP,\n            LocalPort= LocalPort,\n            RemoteIP= RemoteIP,\n            RemotePort = RemotePort,\n            ParentImage= ParentImage,\n            Protocol= Protocol) AS EventData\n\nFROM foreach(\n    row={SELECT * , process_tracker_get(id=Pid) AS pt FROM netstat()},\n    query={\n        SELECT Timestamp,\n          Laddr.IP as LocalIP, Laddr.Port AS LocalPort,\n          Raddr.IP AS RemoteIP, Raddr.Port AS RemotePort,\n          Pid, TypeString AS Protocol, Status, pt.Data.Exe AS Image,\n          pt.Data.CommandLine as CommandLine,\n          process_tracker_get(id=pt.Data.Ppid).Data.Exe AS ParentImage,\n          pt\n        FROM scope()})\n","fields":["CommandLine","Image","LocalIP","LocalPort","RemoteIP","RemotePort","ParentImage","Protocol","Status"]}},"ExportTemplate":"export: |\n  LET X = scope()\n\n  LET DateAfterTime \u003c= X.DateAfter || timestamp(epoch=\"1600-01-01\")\n  LET DateBeforeTime \u003c= X.DateBefore || timestamp(epoch=\"2200-01-01\")\n\n  LET ExcludeRegex \u003c= if(condition=X.RuleExclusions,\n       then=join(array=RuleExclusions.RuleTitleRegex, sep=\"|\"),\n       else=\"XXXXXXX\")\n\n  LET RuleStatusRegex \u003c= get(item=dict(\n       `Stable`=\"stable\",\n       `Stable and Experimental`=\"stable|experimental\",\n       `Stable and Test`=\"stable|test\",\n       `All Rules`=\".\"), member=X.RuleStatus || \"All Rules\")\n\n  LET RuleLevelRegex \u003c= get(item=dict(\n       `Critical`=\"critical\",\n       `Critical and High`=\"critical|high\",\n       `Critical, High, and Medium`=\"critical|high|medium|default\",\n       `All`=\".\"), member=X.RuleLevel || \"All\")\n\n  LET MandatoryLabelLookup \u003c= dict(\n      `S-1-16-0`= 'UNTRUSTED',\n      `S-1-16-4096`= 'LOW_INTEGRITY',\n      `S-1-16-8192`= 'MEDIUM_INTEGRITY',\n      `S-1-16-8448`= 'MEDIUM_HIGH_INTEGRITY',\n      `S-1-16-12288`= 'HIGH_INTEGRITY',\n      `S-1-16-16384`= 'SYSTEM_INTEGRITY',\n      `S-1-16-20480`= 'PROTECTED_PROCESS')\n\n  LET TokenElevationTypeLookup \u003c= dict(\n      `%%1936`= 'FULL_TOKEN',\n      `%%1937`= 'ELEVATED_TOKEN',\n      `%%1938`= 'LIMITED_TOKEN')\n\n  // Helpers for VQL rules\n  LET FetchKeyValues(OSPath) = to_dict(item={\n      SELECT Name AS _key, Data.value AS _value\n      FROM glob(globs=\"*\", accessor=\"registry\", root=OSPath)\n  })\n\n  LET GetValue(OSPath) = stat(filename=OSPath, accessor=\"registry\").Data.value\n  LET Hostname \u003c= dict(H={ SELECT Hostname FROM info()}).H[0].Hostname\n\n  {{ if .LogSources }}\n  LET LogSources \u003c= sigma_log_sources(\n  {{ range .LogSources }}\n    `{{ .Name }}`={\n{{ Indent .Query 5 }}\n    },\n  {{- end -}}\n  `velociraptor/info/*`={ SELECT * FROM info() })\n  {{ end }}\n\n  LET FieldMapping \u003c= parse_json(data=gunzip(string=base64decode(string=\"{{.Base64FieldMapping}}\")))\n\n  LET DefaultDetails \u003c= parse_json(data=gunzip(string=base64decode(string=\"{{.Base64DefaultDetailsLookup}}\")))\n\n  LET DefaultDetailsLambda = '''{{.Base64DefaultDetailsQuery}}'''\n  LET RuleFilterLambda = '''x=\u003ex.Level =~ RuleLevelRegex AND x.Status =~ RuleStatusRegex AND x.Title =~ RuleTitleFilter AND NOT x.Title =~ ExcludeRegex'''\n","DocTemplate":"# Windows Base Sigma Model\n\nThis model is designed for triage of dead disk, or file based live\nanalysis. The rules that use this model will be evaluated once on\nall events.\n\nAfter all relevant rules are evaluated, the collection is complete.\n\n# Log Sources\n\nFollowing is a list of recognized log sources.\n\n{{ range .LogSources }}\n## `{{ .Name }}`\n\n{{ .Description }}\n\n{{ if .Samples }}\n#### Sample Events\n{{ range .Samples }}\n\n##### {{ .Name }}\n\u003cpre class=\"json-renderer\"\u003e\n{{ ReadFile .Json }}\n\u003c/pre\u003e\n{{ end }}\n\n{{ end }}\n\nSample use in a sigma rule:\n```yaml\nlog_sources:\n  {{- if .LogSource.Category }}\n  category: {{ .LogSource.Category }}\n  {{- end }}\n  {{- if .LogSource.Product }}\n  product: {{ .LogSource.Product }}\n  {{- end }}\n  {{- if .LogSource.Service }}\n  service: {{ .LogSource.Service }}\n  {{- end }}\n```\n\n{{ end }}\n","QueryTemplate":"sources:\n- query: |\n   LET Result = SELECT Timestamp,\n         System.Computer AS Computer,\n         System.Channel AS Channel,\n         System.EventID.Value AS EID,\n         _Rule.Level AS Level,\n         _Rule.Title AS Title,\n         System.EventRecordID AS RecordID,\n         Details,\n         dict(System=System,\n              EventData=X.EventData || X.UserData,\n              Message=X.Message) AS _Event,\n         _Match, *\n   FROM sigma(\n     rules=split(string=SigmaRules, sep_string=\"\\n---\\n\"),\n     log_sources= LogSources, debug=Debug,\n     default_details=DefaultDetailsLambda,\n     rule_filter=RuleFilterLambda,\n     field_mapping= FieldMapping)\n\n   SELECT * FROM if(condition=Debug, then={\n     SELECT * FROM Result\n   }, else={\n     SELECT Timestamp, Computer, Channel , EID,\n            Level, Title, RecordID, Details, _Event\n     FROM Result\n   })\n"},"Windows.Sigma.BaseEvents":{"Name":"Windows.Sigma.BaseEvents","Description":"Sigma Model for live monitoring of Windows systems based on local event logs.\n\nThis is a real time monitoring profile which allows live monitoring\nof Windows systems using Sigma rules. This profile only covers event\nlogs by following the EVTX files.\n\nFor more dynamic event monitoring see the Windows.Sigma.ETWBase\nartifact which uses ETW as the monitoring mechanism.\n","Preamble":"name: Windows.Sigma.BaseEvents\ndescription: |\n  This artifact builds the basic set of log sources and field\n  mappings used for Event driven Sigma rules on Windows.\n\n  This artifact was built on {{ .Time }}\n\ntype: CLIENT_EVENT\n\nparameters:\n  - name: ROOT\n    description: The Event Log Directory we use to read all logs\n    default: C:/Windows/System32/WinEvt/Logs/\n\n  - name: Debug\n    type: bool\n    description: Enable full debug trace\n\n  - name: RuleLevel\n    type: choices\n    default: Critical\n    choices:\n      - \"Critical\"\n      - \"Critical and High\"\n      - \"Critical, High, and Medium\"\n      - \"All\"\n\n  - name: RuleStatus\n    type: choices\n    default: Stable\n    choices:\n      - Stable\n      - Stable and Experimental\n      - Stable and Test\n      - All Rules\n\n  - name: RuleTitleFilter\n    type: regex\n    default: .\n    description: Use this to filter only some rules to match\n\n  - name: RuleExclusions\n    type: csv\n    description: |\n      Some rules in the Hayabusa set are extremely noisy, so they\n      are disabled by default.\n    default: |\n      RuleTitleRegex,Reason\n      noisy,All rules marked noisy should be disabled by default.\n\n  - name: SigmaRules\n    description: If provided we use these rules instead of the built in set.\n\n  - name: NTFS_CACHE_TIME\n    type: int\n    description: How often to flush the NTFS cache. (Default is 10 Min).\n    default: \"600\"\n\n  - name: EVTX_FREQUENCY\n    type: int\n    default: 60\n    description: |\n      How often in seconds to check for event log changes. Lower\n      number means more real time detection but potentially higher\n      CPU utilization.\n","FieldMappings":{"":"x=\u003eserialize(item=x.EventData)","AccessList":"x=\u003ex.EventData.AccessList","AccessMask":"x=\u003ex.EventData.AccessMask","Accesses":"x=\u003ex.EventData.Accesses","AccountDomain":"x=\u003ex.EventData.AccountDomain","AccountName":"x=\u003ex.EventData.AccountName","Account_Name":"x=\u003ex.EventData.Account_Name","Action":"x=\u003ex.EventData.Action","Address":"x=\u003ex.EventData.Address","AllowedToDelegateTo":"x=\u003ex.EventData.AllowedToDelegateTo","AppName":"x=\u003ex.EventData.Data[0]","ApplicationPath":"x=\u003ex.EventData.ApplicationPath","AttributeLDAPDisplayName":"x=\u003ex.EventData.AttributeLDAPDisplayName","AttributeValue":"x=\u003ex.EventData.AttributeValue","AuditPolicyChanges":"x=\u003ex.EventData.AuditPolicyChanges","AuditSourceName":"x=\u003ex.EventData.AuditSourceName","AuthenticationPackageName":"x=\u003ex.EventData.AuthenticationPackageName","CallTrace":"x=\u003ex.EventData.CallTrace","CallerProcessName":"x=\u003ex.EventData.CallerProcessName","Caller_Process_Name":"x=\u003ex.EventData.Caller_Process_Name","CallingProcessName":"x=\u003ex.EventData.CallingProcessName","Caption":"x=\u003ex.EventData.Caption","CategoryName":"x=\u003ex.EventData.`Category Name`","CertThumbprint":"x=\u003ex.EventData.CertThumbprint","Channel":"x=\u003ex.System.Channel","ClassName":"x=\u003ex.EventData.ClassName","ClientAddress":"x=\u003ex.EventData.ClientAddress","ClientName":"x=\u003ex.EventData.ClientName","Client_Address":"x=\u003ex.EventData.Client_Address","CommandLine":"x=\u003ex.EventData.CommandLine","Company":"x=\u003ex.EventData.Company","Computer":"x=\u003ex.System.Computer","ComputerName":"x=\u003ex.System.Computer","Contents":"x=\u003ex.EventData.Contents","ContextInfo":"x=\u003ex.EventData.ContextInfo","CurrentDirectory":"x=\u003ex.EventData.CurrentDirectory","Data":"x=\u003eserialize(item=x.EventData)","Description":"x=\u003ex.EventData.Description","DestAddress":"x=\u003ex.EventData.DestAddress","DestPort":"x=\u003ex.EventData.DestPort","Destination":"x=\u003ex.EventData.Destination","DestinationAddress":"x=\u003ex.EventData.DestinationAddress","DestinationHostname":"x=\u003ex.EventData.DestinationHostname","DestinationIp":"x=\u003ex.EventData.DestinationIp","DestinationIsIpv6":"x=\u003ex.EventData.DestinationIsIpv6","DestinationPort":"x=\u003ex.EventData.DestinationPort","Details":"x=\u003ex.EventData.Details","DetectionSource":"x=\u003ex.EventData.DetectionSource","DetectionUser":"x=\u003ex.EventData.`Detection User`","Device":"x=\u003ex.EventData.Device","DeviceClassName":"x=\u003ex.EventData.DeviceClassName","DeviceDescription":"x=\u003ex.EventData.DeviceDescription","DeviceInstanceID":"x=\u003ex.UserData.InstallDeviceID.DeviceInstanceID","DeviceName":"x=\u003ex.EventData.DeviceName","DomainName":"x=\u003ex.EventData.SubjectDomainName","DriverDescription":"x=\u003ex.UserData.InstallDeviceID.DriverDescription","DriverProvider":"x=\u003ex.UserData.InstallDeviceID.DriverProvider","DvrFmwk2003InstanceId":"x=\u003ex.UserData.UMDFHostDeviceArrivalBegin.InstanceId","DvrFmwkInstanceId":"x=\u003ex.UserData.UMDFHostDeviceRequest.InstanceId","ETWFileName":"x=\u003ex.EventData.FileName","EngineVersion":"x=\u003ex.EventData.EngineVersion","ErrorCode":"x=\u003ex.EventData.ErrorCode","EventID":"x=\u003ex.System.EventID.Value","EventType":"x=\u003ex.System.EventType","ExecutionProcessID":"x=\u003ex.System.Execution.ProcessID","FailureCode":"x=\u003ex.EventData.FailureCode","Feature_Name":"x=\u003ex.EventData.`Feature Name`","FilePath":"x=\u003ex.EventData.FilePath","FileVersion":"x=\u003ex.EventData.FileVersion","Filename":"x=\u003ex.EventData.Filename","GrantedAccess":"x=\u003ex.EventData.GrantedAccess","GroupName":"x=\u003ex.EventData.GroupName","GroupSid":"x=\u003ex.EventData.GroupSid","Hash":"x=\u003ex.EventData.Hash","Hashes":"x=\u003ex.EventData.Hashes","HiveName":"x=\u003ex.EventData.HiveName","HostApplication":"x=\u003ex.EventData.HostApplication","HostName":"x=\u003ex.EventData.HostName","HostVersion":"x=\u003ex.EventData.HostVersion","Image":"x=\u003ex.EventData.Image","ImageLoaded":"x=\u003ex.EventData.ImageLoaded","ImagePath":"x=\u003ex.EventData.ImagePath","Imphash":"x=\u003ex.EventData.Hashes","Initiated":"x=\u003ex.EventData.Initiated","InstallStatus":"x=\u003ex.UserData.InstallDeviceID.InstallStatus","InstanceID":"x=\u003ex.UserData.UMDFHostDeviceArrivalBegin.InstanceId","IntegrityLevel":"x=\u003ex.EventData.IntegrityLevel","IpAddress":"x=\u003ex.EventData.IpAddress","IpPort":"x=\u003ex.EventData.IpPort","JobTitle":"x=\u003ex.EventData.name","KeyLength":"x=\u003ex.EventData.KeyLength","Keywords":"x=\u003ex.System.Keywords","LDAPDisplayName":"x=\u003ex.EventData.LDAPDisplayName","LayerRTID":"x=\u003ex.EventData.LayerRTID","Level":"x=\u003ex.System.Level","LogFileClearedChannel":"x=\u003ex.UserData.LogFileCleared.Channel","LogFileClearedSubjectUserName":"x=\u003ex.UserData.LogFileCleared.SubjectUserName","LogonID":"x=\u003ex.EventData.LogonID","LogonId":"x=\u003ex.EventData.LogonId","LogonProcessName":"x=\u003ex.EventData.LogonProcessName","LogonType":"x=\u003ex.EventData.LogonType","Logon_Account":"x=\u003ex.EventData.Logon_Account","Logon_Type":"x=\u003ex.EventData.LogonType","MachineName":"x=\u003ex.EventData.MachineName","MandatoryLabel":"x=\u003eget(item=MandatoryLabelLookup, member=x.EventData.MandatoryLabel || \"-\")\n","MemberName":"x=\u003ex.EventData.MemberName","MemberSid":"x=\u003ex.EventData.MemberSid","Message":"x=\u003ex.EventData","ModifyingApplication":"x=\u003ex.EventData.ModifyingApplication","NewName":"x=\u003ex.EventData.NewName","NewProcessId":"x=\u003ex.EventData.NewProcessId","NewProcessName":"x=\u003ex.EventData.NewProcessName","NewTemplateContent":"x=\u003e x.EventData.NewTemplateContent","NewUacValue":"x=\u003ex.EventData.NewUacValue","NewValue":"x=\u003ex.EventData.NewValue","New_Value":"x=\u003ex.EventData.`New Value`","ObjectClass":"x=\u003ex.EventData.ObjectClass","ObjectName":"x=\u003ex.EventData.ObjectName","ObjectServer":"x=\u003ex.EventData.ObjectServer","ObjectType":"x=\u003ex.EventData.ObjectType","ObjectValueName":"x=\u003ex.EventData.ObjectValueName","OldUacValue":"x=\u003ex.EventData.OldUacValue","OperationEssStartedNamespaceName":"x=\u003ex.UserData.Operation_EssStarted.NamespaceName","OperationEssStartedPossibleCause":"x=\u003ex.UserData.Operation_EssStarted.PossibleCause","OperationEssStartedProcessid":"x=\u003ex.UserData.Operation_EssStarted.Processid","OperationEssStartedProvider":"x=\u003ex.UserData.Operation_EssStarted.Provider","OperationEssStartedQuery":"x=\u003ex.UserData.Operation_EssStarted.Query","OperationEssStartedUser":"x=\u003ex.UserData.Operation_EssStarted.User","Origin":"x=\u003ex.EventData.Origin","OriginalFileName":"x=\u003ex.EventData.OriginalFileName","OriginalFilename":"x=\u003ex.EventData.OriginalFileName","PackageFullName":"x=\u003ex.UserData.PackageFullName","ParentCommandLine":"x=\u003ex.EventData.ParentCommandLine","ParentImage":"x=\u003ex.EventData.ParentImage","ParentProcessName":"x=\u003ex.EventData.ParentProcessName","ParentUser":"x=\u003ex.EventData.ParentUser","PasswordLastSet":"x=\u003ex.EventData.PasswordLastSet","Path":"x=\u003ex.EventData.Path","Payload":"x=\u003ex.EventData.Payload","PipeName":"x=\u003ex.EventData.PipeName","PossibleCause":"x=\u003ex.UserData.PossibleCause","PreAuthType":"x=\u003ex.EventData.PreAuthType","PreviousCreationUtcTime":"x=\u003ex.EventData.PreviousCreationUtcTime","PrivilegeList":"x=\u003ex.EventData.PrivilegeList","ProcessCommandLine":"x=\u003ex.EventData.ProcessCommandLine || x.EventData.ProcInfo.CommandLine","ProcessExe":"x=\u003ex.EventData.ProcInfo.Exe","ProcessGuid":"x=\u003ex.EventData.ProcessGuid","ProcessId":"x=\u003ex.EventData.ProcessId","ProcessName":"x=\u003ex.EventData.ProcessName || x.EventData.ProcInfo.Name","Product":"x=\u003ex.EventData.Product","Properties":"x=\u003ex.EventData.Properties","Protocol":"x=\u003ex.EventData.Protocol","Provider":"x=\u003ex.UserData.Provider","ProviderName":"x=\u003ex.System.Provider.Name","Provider_Name":"x=\u003ex.System.Provider.Name","QNAME":"x=\u003ex.EventData.QNAME","Query":"x=\u003ex.UserData.Query","QueryName":"x=\u003ex.EventData.QueryName","QueryResults":"x=\u003ex.EventData.QueryResults","QueryStatus":"x=\u003ex.EventData.QueryStatus","RelativeTargetName":"x=\u003ex.EventData.RelativeTargetName","RemoteName":"x=\u003ex.EventData.RemoteName","RuleName":"x=\u003ex.EventData.RuleName","SAMAccountName":"x=\u003ex.EventData.SamAccountName","SamAccountName":"x=\u003ex.EventData.SamAccountName","ScriptBlockText":"x=\u003ex.EventData.ScriptBlockText","SearchFilter":"x=\u003ex.System.SearchFilter","SecurityUserID":"x=\u003ex.System.Security.UserID","ServerName":"x=\u003ex.System.ServerName","Service":"x=\u003ex.EventData.Service","ServiceFileName":"x=\u003ex.EventData.ServiceFileName","ServiceName":"x=\u003ex.EventData.ServiceName","ServicePrincipalNames":"x=\u003ex.EventData.ServicePrincipalNames","ServiceStartType":"x=\u003ex.EventData.ServiceStartType","ServiceType":"x=\u003ex.EventData.ServiceType","SeverityID":"x=\u003ex.EventData.`Severity ID`","SeverityName":"x=\u003ex.EventData.`Severity Name`","ShareLocalPath":"x=\u003ex.EventData.ShareLocalPath","ShareName":"x=\u003ex.EventData.ShareName","SidHistory":"x=\u003ex.EventData.SidHistory","Signature":"x=\u003ex.EventData.Signature","SignatureStatus":"x=\u003ex.EventData.SignatureStatus","Signed":"x=\u003ex.EventData.Signed","Source":"x=\u003ex.System.Provider_Name","SourceAddress":"x=\u003ex.EventData.SourceAddress","SourceHostname":"x=\u003ex.EventData.SourceHostname","SourceImage":"x=\u003ex.EventData.SourceImage","SourceIp":"x=\u003ex.EventData.SourceIp","SourceIsIpv6":"x=\u003ex.EventData.SourceIsIpv6","SourceNetworkAddress":"x=\u003ex.EventData.SourceNetworkAddress","SourcePort":"x=\u003ex.EventData.SourcePort","Source_Name":"x=\u003ex.EventData.`Source Name`","Source_Network_Address":"x=\u003ex.EventData.Source_Network_Address","Source_WorkStation":"x=\u003ex.EventData.Source_WorkStation","StartAddress":"x=\u003ex.EventData.StartAddress","StartFunction":"x=\u003ex.EventData.StartFunction","StartModule":"x=\u003ex.EventData.StartModule","StartType":"x=\u003ex.EventData.StartType","State":"x=\u003ex.EventData.State","Status":"x=\u003ex.EventData.Status","SubStatus":"x=\u003ex.EventData.SubStatus","SubjectDomainName":"x=\u003ex.EventData.SubjectDomainName","SubjectLogonId":"x=\u003ex.EventData.SubjectLogonId","SubjectUserName":"x=\u003ex.EventData.SubjectUserName","SubjectUserSid":"x=\u003ex.EventData.SubjectUserSid","SysmonVersion":"x=\u003ex.EventData.SysmonVersion","TargetDomainName":"x=\u003ex.EventData.TargetDomainName","TargetFilename":"x=\u003ex.EventData.TargetFilename","TargetImage":"x=\u003ex.EventData.TargetImage","TargetInfo":"x=\u003ex.EventData.TargetInfo","TargetLogonId":"x=\u003ex.EventData.TargetLogonId","TargetObject":"x=\u003ex.EventData.TargetObject","TargetOutboundUserName":"x=\u003ex.EventData.TargetOutboundUserName","TargetProcessAddress":"x=\u003ex.EventData.TargetProcessAddress","TargetServerName":"x=\u003ex.EventData.TargetServerName","TargetSid":"x=\u003ex.EventData.TargetSid","TargetUserName":"x=\u003ex.EventData.TargetUserName","TaskDate":"x=\u003ex.EventData.TaskContent","TaskName":"x=\u003ex.EventData.TaskName","TemplateContent":"x=\u003ex.EventData.TemplateContent","ThreatName":"x=\u003ex.EventData.`Threat Name`","TicketEncryptionType":"x=\u003ex.EventData.TicketEncryptionType","TicketOptions":"x=\u003ex.EventData.TicketOptions","Timestamp":"x=\u003ex.System.TimeCreated.SystemTime","TokenElevationType":"x=\u003eget(item=TokenElevationTypeLookup, member=x.EventData.TokenElevationType || \"-\")","Type":"x=\u003ex.EventData.Type","Url":"x=\u003ex.EventData.url","User":"x=\u003ex.EventData.User","UserDataAddress":"x=\u003ex.UserData.EventXML.Address","UserDataCode":"x=\u003ex.UserData.Operation_StartedOperational.Code","UserDataConsumer":"x=\u003ex.UserData.Operation_ESStoConsumerBinding.CONSUMER","UserDataESS":"x=\u003ex.UserData.Operation_ESStoConsumerBinding.ESS","UserDataHostProcess":"x=\u003ex.UserData.Operation_StartedOperational.HostProcess","UserDataNamespace":"x=\u003ex.UserData.Operation_ESStoConsumerBinding.Namespace","UserDataNamespaceName":"x=\u003ex.UserData.Operation_TemporaryEssStarted.NamespaceName","UserDataParam1":"x=\u003ex.UserData.EventXML.Param1","UserDataParam2":"x=\u003ex.UserData.EventXML.Param2","UserDataParam3":"x=\u003ex.UserData.EventXML.Param3","UserDataPossibleCause":"x=\u003ex.UserData.Operation_ESStoConsumerBinding.PossibleCause","UserDataProcessID":"x=\u003ex.UserData.Operation_StartedOperational.ProcessID","UserDataProcessid":"x=\u003ex.UserData.Operation_TemporaryEssStarted.Processid","UserDataProviderName":"x=\u003ex.UserData.Operation_StartedOperational.ProviderName","UserDataProviderPath":"x=\u003ex.UserData.Operation_StartedOperational.ProviderPath","UserDataQuery":"x=\u003ex.UserData.Operation_TemporaryEssStarted.Query","UserDataSessionID":"x=\u003ex.UserData.EventXML.SessionID","UserDataUser":"x=\u003ex.UserData.EventXML.User","UserName":"x=\u003ex.EventData.UserName","Value":"x=\u003ex.EventData.Value","Version":"x=\u003ex.System.Version","VhdType":"x=\u003ex.EventData.VhdType","WindowsDefenderProcessName":"x=\u003ex.EventData.`Process Name`","Workstation":"x=\u003ex.EventData.Workstation","WorkstationName":"x=\u003ex.EventData.WorkstationName","image":"x=\u003ex.EventData.Image","md5":"x=\u003eparse_string_with_regex(string=x.EventData.Hash || '', regex='MD5=([^,]+)').g1","param1":"x=\u003ex.EventData.param1","param2":"x=\u003ex.EventData.param2","param3":"x=\u003ex.EventData.param3","param4":"x=\u003ex.EventData.param4","param5":"x=\u003ex.EventData.param5","processPath":"x=\u003ex.EventData.processPath","query":"x=\u003ex.EventData.Query","service":"x=\u003ex.EventData.Service","sha1":"x=\u003ex.EventData.Hashes","sha256":"x=\u003eparse_string_with_regex(string=x.EventData.Hash || '', regex='SHA256=([^,]+)').g1"},"DefaultDetails":{"Query":"x=\u003eget(item=DefaultDetails,\n       member=format(format=\"%v/%v\",\n          args=[x.System.Provider.Name, x.System.EventID.Value])\n      ) || x.Message || x.UserData || x.EventData\n","Lookup":{"MSExchange CmdletLogs/6":"Data: %Data%","Microsoft-Windows-Bits-Client/3":"JobTitle: %jobTitle% ¦ JobID: %jobId% ¦ JobOwner: %jobOwner% ¦ Proc: %processPath% ¦ PID: %ProcessId%","Microsoft-Windows-DNS-Server-Service/150":"DLL: %param1%","Microsoft-Windows-DNS-Server-Service/770":"Path: %param1% ¦ SrcComp: %param2%","Microsoft-Windows-DriverFrameworks-UserMode/2003":"Device: %DvrFmwk2003InstanceId%","Microsoft-Windows-DriverFrameworks-UserMode/2100":"Device: %DvrFmwkInstanceId%","Microsoft-Windows-DriverFrameworks-UserMode/2102":"Device: %DvrFmwkInstanceId%","Microsoft-Windows-Ntfs/98":"Drive: %DriveName% ¦ Device: %DeviceName%","Microsoft-Windows-PowerShell/4103":"Payload: %Payload%","Microsoft-Windows-PowerShell/4104":"ScriptBlock: %ScriptBlockText%","Microsoft-Windows-PrintService/300":"PrinterCreated: %PrinterCreated%","Microsoft-Windows-PrintService/301":"DeletedPrinter: %Param1%","Microsoft-Windows-PrintService/302":"PrinterDeletionPending: %PrinterDeletionPending%","Microsoft-Windows-PrintService/354":"Printer: %Param1% ¦ DLL: %Param2% ¦ Error: %Param3%","Microsoft-Windows-PrintService/823":"OldDefaultPrinter: %OldDefaultPrinter% ¦ NewDefaultPrinter: %NewDefaultPrinter% ¦ Status: %Status% ¦ Module: %Module%","Microsoft-Windows-PrintService/848":"PrinterName: %PrinterName% ¦ ShareName: %ShareName%","Microsoft-Windows-PrintService/849":"PrinterName: %PrinterName% ¦ ShareName: %ShareName%","Microsoft-Windows-Security-Auditing/1102":"User: %LogFileClearedSubjectUserName%","Microsoft-Windows-Security-Auditing/4616":"PrevTime: %PreviousTime% ¦ NewTime: %NewTime% ¦ User: %SubjectUserName% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4624":"Type: %LogonType% ¦ TgtUser: %TargetUserName% ¦ SrcComp: %WorkstationName% ¦ SrcIP: %IpAddress% ¦ LID: %TargetLogonId%","Microsoft-Windows-Security-Auditing/4625":"Type: %LogonType% ¦ TgtUser: %TargetUserName% ¦ SrcComp: %WorkstationName% ¦ SrcIP: %IpAddress% ¦ AuthPkg: %AuthenticationPackageName% ¦ Proc: %ProcessName%","Microsoft-Windows-Security-Auditing/4648":"TgtUser: %TargetUserName% ¦ SrcUser: %SubjectUserName% ¦ SrcIP: %IpAddress% ¦ Proc: %ProcessName% ¦ TgtSvr: %TargetInfo%","Microsoft-Windows-Security-Auditing/4656":"User: %SubjectUserName% ¦ ObjSvr: %ObjectServer% ¦ ObjName: %ObjectName% ¦ ObjType: %ObjectType% ¦ AccessReason: %AccessReason% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ HID: %HandleId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4661":"User: %SubjectUserName% ¦ ObjSvr: %ObjectServer% ¦ ObjType: %ObjectType% ¦ ObjName: %ObjectName% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4662":"User: %SubjectUserName% ¦ ObjSvr: %ObjectServer% ¦ ObjName: %ObjectName% ¦ OpType: %OperationType% ¦ HID: %HandleId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4663":"User: %SubjectUserName% ¦ ObjSvr: %ObjectServer% ¦ ObjName: %ObjectName% ¦ ObjType: %ObjectType% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ HID: %HandleId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4672":"TgtUser: %SubjectUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4673":"Proc: %ProcessName% ¦ User: %SubjectUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4674":"Svc: %ObjectName% ¦ User: %SubjectUserName% ¦ AccessMask: %AccessMask% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4688":"Cmdline: %CommandLine% ¦ Proc: %NewProcessName% ¦ PID: %NewProcessId% ¦ User: %SubjectUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4692":"User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ Domain: %SubjectDomainName% ¦ MasterKeyId: %MasterKeyId% ¦ RecoveryServer: %RecoveryServer% ¦ RecoveryKeyId: %RecoveryKeyId% ¦ FailureReason: %FailureReason%","Microsoft-Windows-Security-Auditing/4697":"Svc: %ServiceName% ¦ Path: %ServiceFileName% ¦ User: %SubjectUserName% ¦ SvcAcct: %ServiceAccount% ¦ SvcType: %ServiceType% ¦ SvcStartType: %ServiceStartType% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4698":"Name: %TaskName% ¦ Content: %TaskContent% ¦ User: %SubjectUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4699":"Name: %TaskName% ¦ User: %SubjectUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4719":"User: %SubjectUserName% ¦ AuditPolicyChanges: %AuditPolicyChanges% ¦ CategoryId: %CategoryId% ¦ SubcategoryGuid: %SubcategoryGuid% ¦ SubcategoryId: %SubcategoryId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4720":"TgtUser: %TargetUserName% ¦ TgtSID: %TargetSid%","Microsoft-Windows-Security-Auditing/4728":"SrcSID: %MemberSid% ¦ TgtGrp: %TargetUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4732":"SrcSID: %MemberSid% ¦ TgtGrp: %TargetUserName% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4738":"User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ TgtUser: %TargetUserName% ¦ TgtSID: %TargetSid% ¦ Domain: %SubjectDomainName% ¦ TgtDomain: %TargetDomainName% ¦ SamUser: %SamAccountName% ¦ DisplayName: %DisplayName% ¦ UAC: %UserAccountControl% ¦ OldUAC: %OldUacValue% ¦ NewUAC: %NewUacValue% ¦ AcctExpires: %AccountExpires% ¦ AllowedToDelegateTo: %AllowedToDelegateTo% ¦ HomeDir: %HomeDirectory% ¦ HomePath: %HomePath% ¦ LogonHours: %LogonHours% ¦  PwLastSet: %PasswordLastSet% ¦ PrimaryGrpID: %PrimaryGroupId% ¦ PrivList: %PrivilegeList% ¦ ProfilePath: %ProfilePath% ¦ ScriptPath: %ScriptPath% ¦ SidHistory: %SidHistory% ¦ UserParams: %UserParameters% ¦ UPN: %UserPrincipalName% ¦ SrcComp: %UserWorkstations% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4742":"SPN: %ServicePrincipalNames% ¦ User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ TgtUser: %TargetUserName% ¦ TgtSID: %TargetSid% ¦ Domain: %SubjectDomainName% ¦ TgtDomain: %TargetDomainName% ¦ SamUser: %SamAccountName% ¦ DisplayName: %DisplayName% ¦ UAC: %UserAccountControl% ¦ OldUAC: %OldUacValue% ¦ NewUAC: %NewUacValue% ¦ AcctExpires: %AccountExpires% ¦ AllowedToDelegateTo: %AllowedToDelegateTo% ¦ HomeDir: %HomeDirectory% ¦ HomePath: %HomePath% ¦ LogonHours: %LogonHours% ¦  PwLastSet: %PasswordLastSet% ¦ PrimaryGrpID: %PrimaryGroupId% ¦ PrivList: %PrivilegeList% ¦ ProfilePath: %ProfilePath% ¦ ScriptPath: %ScriptPath% ¦ SidHistory: %SidHistory% ¦ UserParams: %UserParameters% ¦ UPN: %UserPrincipalName% ¦ SrcComp: %UserWorkstations% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4765":"User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ SrcUser: %SourceUserName% ¦ SrcSID: %SourceSid% ¦ TgtUser: %TargetUserName% ¦ TgtSID: %TargetSid% ¦ Domain: %SubjectDomainName% ¦ TgtDomain: %TargetDomainName% ¦ PrivList: %PrivilegeList% ¦ SidList: %SidList% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4768":"TgtUser: %TargetUserName% ¦ Svc: %ServiceName% ¦ SrcIP: %IpAddress% ¦ Status: %Status% ¦ PreAuthType: %PreAuthType%","Microsoft-Windows-Security-Auditing/4769":"TgtUser: %TargetUserName% ¦ Svc: %ServiceName% ¦ SrcIP: %IpAddress% ¦ Status: %Status%","Microsoft-Windows-Security-Auditing/4776":"TgtUser: %TargetUserName% ¦ SrcComp: %Workstation% ¦ Status: %Status%","Microsoft-Windows-Security-Auditing/4778":"SrcUser: %AccountName% ¦ Domain: %AccountDomain% ¦ SrcIP: %ClientAddress% ¦ SrcComp: %ClientName% ¦ LID: %LogonID%","Microsoft-Windows-Security-Auditing/4779":"SrcUser: %AccountName% ¦ Domain: %AccountDomain% ¦ SrcIP: %ClientAddress% ¦ SrcComp: %ClientName% ¦ LID: %LogonID%","Microsoft-Windows-Security-Auditing/4781":"OldTgtUser: %OldTargetUserName% ¦ NewTgtUser: %NewTargetUserName% ¦ TgtSID: %TargetSid% ¦ User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ Domain: %SubjectDomainName% ¦ TgtDomain: %TargetDomainName% ¦ PrivList: %PrivilegeList% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4794":"User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ Domain: %SubjectDomainName% ¦ Status: %Status% ¦ SrcComp: %Workstation% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4825":"Domain: %AccountDomain% ¦ User: %AccountName% ¦ SrcIP: %ClientAddress% ¦ LID: %LogonID%","Microsoft-Windows-Security-Auditing/4904":"AuditSrcName: %AuditSourceName% ¦ EventSrcID: %EventSourceId% ¦ User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ Domain: %SubjectDomainName% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/4905":"AuditSrcName: %AuditSourceName% ¦ User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ Proc: %ProcessName% ¦ PID: %ProcessId% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/5038":"Path: %param1%","Microsoft-Windows-Security-Auditing/5136":"User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ ObjDN: %ObjectDN% ¦ AttrLDAPName: %AttributeLDAPDisplayName% ¦ OpType: %OperationType% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/5140":"SrcUser: %SubjectUserName% ¦ ShareName: %ShareName% ¦ SharePath: %ShareLocalPath% ¦ SrcIP: %IpAddress% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/5142":"User: %SubjectUserName% ¦ ShareName: %ShareName% ¦ ShareLocalPath: %ShareLocalPath% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/5145":"SrcUser: %SubjectUserName% ¦ ShareName: %ShareName% ¦ SharePath: %ShareLocalPath% ¦ Path: %RelativeTargetName% ¦ SrcIP: %IpAddress% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Security-Auditing/5156":"Proc: %Application% ¦ SrcIP: %SourceAddress% ¦ SrcPort: %SourcePort% ¦ TgtIP: %DestAddress% ¦ TgtPort: %DestPort% ¦ Protocol: %Protocol% ¦ TgtMachineID: %RemoteMachineID% ¦ TgtSID: %RemoteUserID% ¦ PID: %ProcessID%","Microsoft-Windows-Security-Auditing/5157":"Proc: %Application% ¦ SrcIP: %SourceAddress% ¦ SrcPort: %SourcePort% ¦ TgtIP: %DestAddress% ¦ TgtPort: %DestPort% ¦ Protocol: %Protocol% ¦ TgtMachineID: %RemoteMachineID% ¦ TgtSID: %RemoteUserID% ¦ PID: %ProcessID%","Microsoft-Windows-Security-Auditing/5379":"PID: %ClientProcessId% ¦ SrcUser: %SubjectUserName% ¦ Tgt: %TargetName% ¦ CredsReturned: %CountOfCredentialsReturned% ¦ ReturnCode: %ReturnCode% ¦ LID: %SubjectLogonId% ¦ SrcSID: %SubjectUserSid%","Microsoft-Windows-Security-Auditing/6281":"Path: %param1%","Microsoft-Windows-Security-Auditing/6416":"DeviceDescrip: %DeviceDescription% ¦ DeviceID: %DeviceId% ¦ LocInfo: %LocationInformation% ¦ CompatibleIDs: %CompatibleIds% ¦ User: %SubjectUserName% ¦ SID: %SubjectUserSid% ¦ LID: %SubjectLogonId%","Microsoft-Windows-Sysmon/1":"Cmdline: %CommandLine% ¦ Proc: %Image% ¦ User: %User% ¦ ParentCmdline: %ParentCommandLine% ¦ LID: %LogonId% ¦ LGUID: %LogonGuid% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid% ¦ ParentPID: %ParentProcessId% ¦ ParentPGUID: %ParentProcessGuid% ¦ Description: %Description% ¦ Product: %Product% ¦ Company: %Company% ¦ Hashes: %Hashes%","Microsoft-Windows-Sysmon/10":"SrcProc: %SourceImage% ¦ TgtProc: %TargetImage% ¦ SrcUser: %SourceUser% ¦ TgtUser: %TargetUser% ¦ Access: %GrantedAccess% ¦ SrcPID: %SourceProcessId% ¦ SrcPGUID: %SourceProcessGUID% ¦ TgtPID: %TargetProcessId% ¦ TgtPGUID: %TargetProcessGUID%","Microsoft-Windows-Sysmon/11":"Path: %TargetFilename% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/12":"EventType: %EventType% ¦ TgtObj: %TargetObject% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/13":"EventType: %EventType% ¦ TgtObj: %TargetObject%: %Details% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/14":"EventType: %EventType% ¦ TgtObj: %TargetObject%: %Details% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/15":"Path: %TargetFilename% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid% ¦ Hash: %Hash%","Microsoft-Windows-Sysmon/16":"Config: %Configuration%","Microsoft-Windows-Sysmon/17":"Pipe: %PipeName% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/18":"Pipe: %PipeName% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/19":"Op: %Operation% ¦ Namespace: %EventNamespace% ¦ Name: %Name% ¦ Query: %query% ¦ User: %User%","Microsoft-Windows-Sysmon/2":"Path: %TargetFilename% ¦ Proc: %Image% ¦ User: %User% ¦ CreationTime: %CreationUtcTime% ¦ PreviousTime: %PreviousCreationUtcTime% ¦ PID: %PID% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/20":"Op: %Operation% ¦ Type: %Type% ¦ Name: %Name% ¦ Tgt: %Destination% ¦ User: %User%","Microsoft-Windows-Sysmon/21":"Op: %Operation% ¦ Consumer: %Consumer% ¦ Filter: %Filter%","Microsoft-Windows-Sysmon/22":"Query: %QueryName% ¦ Result: %QueryResults% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/23":"Path: %TargetFilename% ¦ Proc: %Image% ¦ User: %User% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/24":"Proc: %Image% ¦ User: %User% ¦ CliInfo: %ClientInfo% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/25":"Proc: %Image% ¦ Type: %Type% ¦ User: %User% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/255":"ID: %ID% ¦ Description: %Description%","Microsoft-Windows-Sysmon/26":"Path: %TargetFilename% ¦ Proc: %Image% ¦ User: %User% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/3":"Initiated: %Initiated% ¦ Proto: %Protocol% ¦ SrcIP: %SourceIp% ¦ SrcPort: %SourcePort% ¦ SrcHost: %SourceHostname% ¦ TgtIP: %DestinationIp% ¦ TgtPort: %DestinationPort% ¦ TgtHost: %DestinationHostname% ¦ User: %User% ¦ Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/4":"State: %State% ¦ SysmonVer: %SysmonVersion% ¦ SchemaVer: %SchemaVersion%","Microsoft-Windows-Sysmon/5":"Proc: %Image% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-Sysmon/6":"Path: %ImageLoaded% ¦ Sig: %Signature% ¦ Signed: %Signed% ¦ SigStatus: %SignatureStatus% ¦ Hashes: %Hashes%","Microsoft-Windows-Sysmon/7":"Image: %ImageLoaded% ¦ Proc: %Image% ¦ Description: %Description% ¦ Product: %Product% ¦ Company: %Company% ¦ Signed: %Signed% ¦ Sig: %SignatureStatus% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid% ¦ Hash: %Hashes% ¦ OrigFilename: %OriginalFilename%","Microsoft-Windows-Sysmon/8":"SrcProc: %SourceImage% ¦ TgtProc: %TargetImage% ¦ SrcPID: %SourceProcessId% ¦ SrcPGUID: %SourceProcessGuid% ¦ TgtPID: %TargetProcessId% ¦ TgtPGUID: %TargetProcessGuid%","Microsoft-Windows-Sysmon/9":"Proc: %Image% ¦ Device: %Device% ¦ PID: %ProcessId% ¦ PGUID: %ProcessGuid%","Microsoft-Windows-WMI-Activity/5859":"Namespace: %OperationEssStartedNamespaceName% ¦ Query: %UserDataQuery% ¦ SID: %OperationEssStartedUser% ¦ PID: %OperationEssStartedProcessid% ¦ Provider: %OperationEssStartedProvider% ¦ PossibleCause: %OperationEssStartedPossibleCause%","Microsoft-Windows-Windows Defender/1013":"Time: %Timestamp% ¦ User: %User%","Microsoft-Windows-Windows Defender/1116":"Threat: %ThreatName% ¦ Severity: %SeverityName% ¦ Type: %CategoryName% ¦ User: %DetectionUser% ¦ Path: %Path% ¦ Proc: %WindowsDefenderProcessName%","Microsoft-Windows-Windows Firewall With Advanced Security/2003":"Profile: %Profiles% ¦ Type: %SettingType% ¦ Value: %SettingValueString% ¦ User: %ModifyingUser% ¦ App: %ModifyingApplication%","Microsoft-Windows-Windows Firewall With Advanced Security/2004":"RuleName: %RuleName% ¦ App: %ApplicationPath% ¦ ModifyingApp: %ModifyingApplication% ¦ User: %ModifyingUser% ¦ Svc: %ServiceName% ¦ Protocol: %Protocol% ¦ LocalAddr: %LocalAddresses% ¦ LocalPort: %LocalPorts% ¦ RemoteAddr: %RemoteAddresses% ¦ RemotePort: %RemotePorts% ¦ Action: %Action%","MsiInstaller/1034":"Product: %Data[1]% ¦ Ver: %Data[2]% ¦ Vendor: %Data[5]% ¦ Status: %Data[4]%","MsiInstaller/11724":"Product: %Data[1]%","PowerShellCore/4103":"Payload: %Payload%","PowerShellCore/4104":"ScriptBlock: %ScriptBlockText%","Service Control Manager/7031":"Svc: %param1% ¦ CrashCount: %param2% ¦ Action: %param5%","Service Control Manager/7045":"Svc: %ServiceName% ¦ Path: %ImagePath% ¦ Acct: %AccountName% ¦ StartType: %StartType%"}},"Sources":{"*/windows/application":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Application.evtx\")\n","channel":["Application"],"fields":["Channel","EventID"]},"*/windows/applocker":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=[\n  ROOT + \"/Microsoft-Windows-AppLocker%4MSI and Script.evtx\",\n  ROOT + \"/Microsoft-Windows-AppLocker%4EXE and DLL.evtx\",\n  ROOT + \"/Microsoft-Windows-AppLocker%4Packaged app-Deployment.evtx\",\n  ROOT + \"/Microsoft-Windows-AppLocker%4Packaged app-Execution.evtx\",\n])\n","channel":["Microsoft-Windows-AppLocker/MSI and Script","Microsoft-Windows-AppLocker/EXE and DLL","Microsoft-Windows-AppLocker/Packaged app-Deployment","Microsoft-Windows-AppLocker/Packaged app-Execution"],"fields":["Channel","EventID"]},"*/windows/appmodel-runtime":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-AppModel-Runtime%4Admin.evtx\")\n","channel":["Microsoft-Windows-AppModel-Runtime/Admin"],"fields":["Channel","EventID"]},"*/windows/appxdeployment-server":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-AppxPackaging%4Operational.evtx\")\n","channel":["Microsoft-Windows-AppxPackaging/Operational"],"fields":["Channel","EventID"]},"*/windows/appxpackaging-om":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-AppxPackaging%4Operational.evtx\")\n","channel":["Microsoft-Windows-AppxPackaging/Operational"],"fields":["Channel","EventID"]},"*/windows/bits-client":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-Bits-Client%4Operational.evtx\")\n","channel":["Microsoft-Windows-Bits-Client/Operational"],"fields":["Channel","EventID","processPath","RemoteName"]},"*/windows/capi2":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-CAPI2/Operational\")\n","channel":["Microsoft-Windows-CAPI2/Operational"],"fields":["Channel","EventID"]},"*/windows/certificateservicesclient-lifecycle-system":{"query":"SELECT * FROM parse_evtx(filename=ROOT + \"/Microsoft-Windows-CertificateServicesClient-Lifecycle-System/Operational\")\n","channel":["Microsoft-Windows-CertificateServicesClient-Lifecycle-System/Operational"],"fields":["Channel","EventID"]},"*/windows/codeintegrity-operational":{"query":"SELECT * FROM watch_evtx(accessor=\"file\",\n   filename=ROOT + \"/Microsoft-Windows-CodeIntegrity%4Operational.evtx\")\n","channel":["Microsoft-Windows-CodeIntegrity/Operational"],"fields":["Channel","EventID"]},"*/windows/diagnosis-scripted":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-Diagnosis-Scripted%4Operational.evtx\")\n","channel":["Microsoft-Windows-Diagnosis-Scripted/Operational"],"fields":["Channel","EventID"]},"*/windows/dns-client":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-DNS Client Events%4Operational.evtx\")\n","channel":["Microsoft-Windows-DNS Client Events/Operational"],"fields":["Channel","EventID"]},"*/windows/dns-server":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/DNS Server.evtx\")\n","channel":["DNS Server"],"fields":["Channel","EventID"]},"*/windows/dns-server-analytic":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-DNS-Server%4Analytical.evtx\")\n","channel":["Microsoft-Windows-DNS-Server/Analytical"],"fields":["Channel","EventID"]},"*/windows/driver-framework":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-DriverFrameworks-UserMode%4Operational.evtx\")\n","channel":["Microsoft-Windows-DriverFrameworks-UserMode/Operational"],"fields":["Channel","EventID"]},"*/windows/firewall-as":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-Windows Firewall With Advanced Security%4Firewall.evtx\")\n","channel":["Microsoft-Windows-Windows Firewall With Advanced Security/Firewall"],"fields":["Channel","EventID"]},"*/windows/ldap_debug":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-LDAP-Client%4Debug.evtx\")\n","channel":["Microsoft-Windows-LDAP-Client/Debug"],"fields":["Channel","EventID"]},"*/windows/lsa-server":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-LSA%4Operational.evtx\")\n","channel":["Microsoft-Windows-LSA/Operational"],"fields":["Channel","EventID"]},"*/windows/microsoft-servicebus-client":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-ServiceBus-Client.evtx\")\n","channel":["Microsoft-ServiceBus-Client"],"fields":["Channel","EventID"]},"*/windows/msexchange-management":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/MSExchange Management.evtx\")\n","channel":["MSExchange Management"],"fields":["Channel","EventID"]},"*/windows/ntlm":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-NTLM%4Operational.evtx\")\n","channel":["Microsoft-Windows-NTLM/Operational"],"fields":["Channel","EventID"]},"*/windows/openssh":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/OpenSSH%4Operational.evtx\")\n","channel":["OpenSSH/Operational"],"fields":["Channel","EventID"]},"*/windows/powershell":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=[\n   ROOT + \"/Microsoft-Windows-PowerShell%4Operational.evtx\",\n   ROOT + \"/PowerShellCore%4Operational.evtx\",\n])\n","channel":["Microsoft-Windows-PowerShell/Operational","PowerShellCore/Operational"],"fields":["Channel","EventID","MessageNumber","MessageTotal","ScriptBlockText","ScriptBlockId","ContextInfo","UserData","Payload"]},"*/windows/powershell-classic":{"query":"SELECT *, EventData + dict(\n   Data=EventData.Data[2],\n   HostApplication=parse_string_with_regex(\n     regex=\"HostApplication=([^\\\\r\\\\n]+)\",\n     string=EventData.Data[2]).g1) AS EventData\nFROM watch_evtx(accessor='file', filename=ROOT + \"/Windows PowerShell.evtx\")\n","channel":["Windows PowerShell"],"fields":["Channel","EventID"]},"*/windows/printservice-admin":{},"*/windows/printservice-operational":{},"*/windows/security":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Security.evtx\")\n","channel":["Security"],"fields":["Channel","EventID"]},"*/windows/security-mitigations":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-Security-Mitigations.evtx\")\n","channel":["Microsoft-Windows-Security-Mitigations"]},"*/windows/shell-core":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-Shell-Core%4Operational.evtx\")\n","channel":["Microsoft-Windows-Shell-Core/Operational"],"fields":["Channel","EventID"]},"*/windows/smbclient-connectivity":{},"*/windows/smbclient-security":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-SmbClient%4Security.evtx\")\n","channel":["Microsoft-Windows-SmbClient/Security"],"fields":["Channel","EventID"]},"*/windows/sysmon":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-Sysmon%4Operational.evtx\")\n","channel":["Microsoft-Windows-Sysmon/Operational"],"fields":["Channel","EventID","Provider_Name","Imphash","sha1","sha256","md5","ImagePath","TargetParentImage"]},"*/windows/system":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/System.evtx\")\n","channel":["System"],"fields":["Channel","EventID","Caption"]},"*/windows/taskscheduler":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-TaskScheduler%4Operational.evtx\")\n","channel":["Microsoft-Windows-TaskScheduler/Operational"],"fields":["Channel","EventID"]},"*/windows/terminalservices-localsessionmanager":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx\")\n","channel":["Microsoft-Windows-TerminalServices-LocalSessionManager/Operational"],"fields":["Channel","EventID","Address"]},"*/windows/vhdmp":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-VHDMP%4Operational.evtx\")\n","channel":["Microsoft-Windows-VHDMP/Operational"],"fields":["EventID","VhdType","Channel"]},"*/windows/windefend":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-Windows Defender%4Operational.evtx\")\n","channel":["Microsoft-Windows-Windows Defender/Operational"],"fields":["Channel","EventID","SeverityID","ThreatName"]},"*/windows/wmi":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-WMI-Activity%4Operational.evtx\")\n","channel":["Microsoft-Windows-WMI-Activity/Operational"],"fields":["Channel","EventID"]},"process_creation/windows/*":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=[\n   ROOT + \"/Microsoft-Windows-Sysmon%4Operational.evtx\",\n   ROOT + \"/System.evtx\"\n])\nWHERE System.EventID.Value = 1 OR System.EventID.Value = 4688\n","fields":["Channel","EventID"]},"ps_classic_provider_start/windows/*":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Windows PowerShell.evtx\")\nWHERE System.EventID.Value = 600\n","fields":["Channel","EventID"]},"ps_classic_start/windows/*":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Windows PowerShell.evtx\")\nWHERE System.EventID.Value = 400\n","fields":["Channel","EventID"]},"ps_module/windows/*":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=[\n   ROOT + \"/Microsoft-Windows-PowerShell%4Operational.evtx\",\n   ROOT + \"/PowerShellCore%4Operational.evtx\"\n])\nWHERE System.EventID.Value = 4103\n","fields":["Channel","EventID"]},"ps_script/windows/*":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=[\n   ROOT + \"/Microsoft-Windows-PowerShell%4Operational.evtx\",\n   ROOT + \"/PowerShellCore%4Operational.evtx\"\n])\nWHERE System.EventID.Value = 4104\n","fields":["Channel","EventID"]},"registry_add/windows/*":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=[\n   ROOT + \"/Microsoft-Windows-Sysmon%4Operational.evtx\",\n   ROOT + \"/Security.evtx\"\n])\nWHERE System.EventID.Value = 12 OR System.EventID.Value = 4657\n","fields":["Channel","EventID"]},"registry_event/windows/*":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=[\n   ROOT + \"/Microsoft-Windows-Sysmon%4Operational.evtx\",\n   ROOT + \"/Security.evtx\"\n])\nWHERE System.EventID.Value IN (12, 13, 14) OR System.EventID.Value = 4657\n","fields":["Channel","EventID"]},"registry_set/windows/*":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=[\n   ROOT + \"/Microsoft-Windows-Sysmon%4Operational.evtx\",\n   ROOT + \"/Security.evtx\"\n])\nWHERE System.EventID.Value = 13 OR System.EventID.Value = 4657\n","fields":["Channel","EventID"]},"antivirus/windows/windefend":{"query":"SELECT * FROM watch_evtx(accessor='file', filename=ROOT + \"/Microsoft-Windows-Windows Defender%4Operational.evtx\")\n","channel":["Microsoft-Windows-Windows Defender/Operational"],"fields":["Channel","EventID"]}},"ExportTemplate":"export: |\n  -- Add some defaults\n  LET X = scope()\n  LET RuleLevel \u003c= X.RuleLevel || \"All\"\n  LET RuleStatus \u003c= X.RuleStatus || \"All Rules\"\n  LET RuleTitleFilter \u003c= X.RuleTitleFilter || \".\"\n  LET RuleExclusions \u003c= X.RuleExclusions || NULL\n\n  LET ExcludeRegex \u003c= if(condition=RuleExclusions,\n       then=join(array=RuleExclusions.RuleTitleRegex, sep=\"|\"),\n       else=\"XXXXXXX\")\n\n  LET RuleStatusRegex \u003c= get(item=dict(\n       `Stable`=\"stable\",\n       `Stable and Experimental`=\"stable|experimental\",\n       `Stable and Test`=\"stable|test\",\n       `All Rules`=\".\"), member=RuleStatus)\n\n  LET RuleLevelRegex \u003c= get(item=dict(\n       `Critical`=\"critical\",\n       `Critical and High`=\"critical|high\",\n       `Critical, High, and Medium`=\"critical|high|medium|default\",\n       `All`=\".\"), member=RuleLevel)\n\n  LET MandatoryLabelLookup \u003c= dict(\n      `S-1-16-0`= 'UNTRUSTED',\n      `S-1-16-4096`= 'LOW_INTEGRITY',\n      `S-1-16-8192`= 'MEDIUM_INTEGRITY',\n      `S-1-16-8448`= 'MEDIUM_HIGH_INTEGRITY',\n      `S-1-16-12288`= 'HIGH_INTEGRITY',\n      `S-1-16-16384`= 'SYSTEM_INTEGRITY',\n      `S-1-16-20480`= 'PROTECTED_PROCESS')\n\n  LET TokenElevationTypeLookup \u003c= dict(\n      `%%1936`= 'FULL_TOKEN',\n      `%%1937`= 'ELEVATED_TOKEN',\n      `%%1938`= 'LIMITED_TOKEN')\n  LET GetValue(OSPath) = stat(filename=OSPath, accessor=\"registry\").Data.value\n  LET Hostname \u003c= dict(H={ SELECT Hostname FROM info()}).H[0].Hostname\n\n  LET WindowsKernelFile_EIDLookup \u003c= dict(\n       `10`=\"NameCreate\", `11`=\"NameDelete\", `12`=\"FileOpen\",\n       `19`=\"Rename\", `27`=\"RenamePath\",`30`=\"CreateNewFile\")\n\n  LET WindowsKernelFile_Keyword \u003c= 0x1490\n\n  LET WindowsKernelProcess_EIDLookup \u003c= dict(\n    `1`=\"ProcessStart\", `2`=\"ProcessStop\",\n    `5`=\"ImageLoad\", `6`=\"ImageUnload\")\n\n  LET WindowsKernelProcess_Keyword \u003c= 0x50\n\n  LET WindowsKernelRegistry_EIDLookup \u003c= dict(\n    `2`=\"OpenKey\", `1`=\"CreateKey\", `5`=\"SetValueKey\",\n    `6`=\"DeleteValueKey\", `3`=\"DeleteKey\")\n\n  -- SetValueKey | DeleteValueKey | CreateKey | OpenKey | DeleteKey = 0x100 | 0x200 | 0x1000 | 0x2000 | 0x4000\n  LET WindowsKernelRegistry_Keyword \u003c= 0x7300\n\n  {{ if .LogSources }}\n  LET LogSources \u003c= sigma_log_sources(\n  {{ range .LogSources }}\n    `{{ .Name }}`={\n{{ Indent .Query 5 }}\n    },\n  {{- end -}}\n  `velociraptor/info/*`={ SELECT * FROM info() })\n  {{ end }}\n\n  LET FieldMapping \u003c= parse_json(data=gunzip(string=base64decode(string=\"{{.Base64FieldMapping}}\")))\n\n  LET DefaultDetails \u003c= parse_json(data=gunzip(string=base64decode(string=\"{{.Base64DefaultDetailsLookup}}\")))\n\n  LET DefaultDetailsLambda = '''{{.Base64DefaultDetailsQuery}}'''\n  LET RuleFilterLambda = '''x=\u003ex.Level =~ RuleLevelRegex AND x.Status =~ RuleStatusRegex AND x.Title =~ RuleTitleFilter AND NOT x.Title =~ ExcludeRegex'''\n","DocTemplate":"# Windows Base Sigma Model\n\nThis model is designed for triage of dead disk, or file based live\nanalysis. The rules that use this model will be evaluated once on\nall events.\n\nAfter all relevant rules are evaluated, the collection is complete.\n\n# Log Sources\n\nFollowing is a list of recognized log sources.\n\n{{ range .LogSources }}\n## `{{ .Name }}`\n\n{{ .Description }}\n\n{{ if .Samples }}\n#### Sample Events\n{{ range .Samples }}\n\n##### {{ .Name }}\n\u003cpre class=\"json-renderer\"\u003e\n{{ ReadFile .Json }}\n\u003c/pre\u003e\n{{ end }}\n\n{{ end }}\n\nSample use in a sigma rule:\n```yaml\nlog_sources:\n  {{- if .LogSource.Category }}\n  category: {{ .LogSource.Category }}\n  {{- end }}\n  {{- if .LogSource.Product }}\n  product: {{ .LogSource.Product }}\n  {{- end }}\n  {{- if .LogSource.Service }}\n  service: {{ .LogSource.Service }}\n  {{- end }}\n```\n\n{{ end }}\n","QueryTemplate":"sources:\n- query: |\n   LET Result = SELECT timestamp(epoch=System.TimeCreated.SystemTime) AS Timestamp,\n         System.Computer AS Computer,\n         System.Channel AS Channel,\n         System.EventID.Value AS EID,\n         _Rule.Level AS Level,\n         _Rule.Title AS Title,\n         System.EventRecordID AS RecordID,\n         Details,\n         dict(System=System,\n              EventData=X.EventData || X.UserData,\n              Message=X.Message) AS _Event,\n         _Match\n   FROM sigma(\n     rules=split(string= Rules, sep_string=\"\\n---\\n\"),\n     log_sources= LogSources, debug=Debug,\n     default_details='''{{.Base64DefaultDetailsQuery}}''',\n     rule_filter=\"x=\u003ex.Level =~ RuleLevelRegex AND x.Status =~ RuleStatusRegex AND x.Title =~ RuleTitleFilter AND NOT x.Title =~ ExcludeRegex\",\n     field_mapping= FieldMapping)\n\n   SELECT * FROM if(condition=Debug, then={\n     SELECT * FROM Result\n   }, else={\n     SELECT Timestamp, Computer, Channel , EID,\n            Level, Title, RecordID, Details, _Event\n     FROM Result\n   })\n"}}