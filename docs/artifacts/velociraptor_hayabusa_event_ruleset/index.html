<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Velociraptor Hayabusa Live Detection
  #

These rules are automatically imported from the Hayabusa
project and
SigmaHQ.
Rules are automatically compiled using the configuation
file
into an artifact pack.
To download the latest version of the artifact pack click
here
These rules are designed to work in live mode. This means the rules
will match events on the endpoint directly as the event logs are
written to the system event logs. Velociraptor will therefore forward
only matching detections rather than all events."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://sigma.velocidex.com/docs/artifacts/velociraptor_hayabusa_event_ruleset/"><meta property="og:site_name" content="Velociraptor Curated Sigma"><meta property="og:title" content="Velociraptor Hayabusa Live Detection"><meta property="og:description" content="Velociraptor Hayabusa Live Detection # These rules are automatically imported from the Hayabusa project and SigmaHQ.
Rules are automatically compiled using the configuation file into an artifact pack.
To download the latest version of the artifact pack click here
These rules are designed to work in live mode. This means the rules will match events on the endpoint directly as the event logs are written to the system event logs. Velociraptor will therefore forward only matching detections rather than all events."><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>Velociraptor Hayabusa Live Detection | Velociraptor Curated Sigma</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=http://sigma.velocidex.com/docs/artifacts/velociraptor_hayabusa_event_ruleset/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><link rel=alternate type=application/rss+xml href=http://sigma.velocidex.com/docs/artifacts/velociraptor_hayabusa_event_ruleset/index.xml title="Velociraptor Curated Sigma"><script src=/js/jquery-3.3.1.min.js?1703133391></script><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1703133392 rel=stylesheet><link href=/css/theme.css rel=stylesheet></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Velociraptor Curated Sigma</span></a></h2><ul><li><a href=/docs/sigma_in_velociraptor/>Sigma In Velociraptor</a><ul></ul></li><li><a href=/docs/artifacts/>Velociraptor Artifacts</a><ul><li><a href=/docs/artifacts/velociraptor_chopchopgo_ruleset/>Velociraptor ChopChopGo Ruleset (Linux)</a><ul></ul></li><li><a href=/docs/artifacts/velociraptor_hayabusa_event_ruleset/ class=active>Velociraptor Hayabusa Live Detection</a><ul></ul></li><li><a href=/docs/artifacts/velociraptor_hayabusa_ruleset/>Velociraptor Hayabusa Ruleset</a><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Velociraptor Hayabusa Live Detection</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#search-the-hayabusa-ruleset>Search the Hayabusa ruleset</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=velociraptor-hayabusa-live-detection>Velociraptor Hayabusa Live Detection
<a class=anchor href=#velociraptor-hayabusa-live-detection>#</a></h1><p>These rules are automatically imported from the <a href=https://github.com/Yamato-Security/hayabusa>Hayabusa
project</a> and
<a href=https://github.com/SigmaHQ/sigma>SigmaHQ</a>.</p><p>Rules are automatically compiled using the <a href=https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/config/velociraptor_windows_event_monitoring.yaml>configuation
file</a>
into an artifact pack.</p><p>To download the latest version of the artifact pack <a href=https://sigma.velocidex.com/Velociraptor-Hayabusa-Monitoring.zip>click
here</a></p><p>These rules are designed to work in live mode. This means the rules
will match events on the endpoint directly as the event logs are
written to the system event logs. Velociraptor will therefore forward
only matching detections rather than all events.</p><p>This artifact relies on the <code>watch_evtx()</code> plugin. This plugin will
follow the windows event logs (similar to <code>tail -f</code> on Linux) and
parse events periodically.</p><p>There are some differences between this approach as compared to real
event log sources (such as <code>ETW</code>):</p><ol><li>The log file following approach amortizes CPU load over time, if
the check period is not too frequent CPU load can be lower than
ETW.</li><li>The <code>watch_evtx()</code> approach does not rely on Windows ETW and
therefore does not impact limited ETW session resources.</li><li>ETW based monitoring is more real time, which will send detections
to the server sooner.</li></ol><h3 id=search-the-hayabusa-ruleset>Search the Hayabusa ruleset
<a class=anchor href=#search-the-hayabusa-ruleset>#</a></h3><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js></script><div class=input-group><input type=text id=myInput onkeyup=doSearch() class=form-control placeholder="Search rules" aria-describedby=basic-addon2>
<span class=input-group-addon id=basic-addon2><i class="fas fa-search"></i></span></div><hr><div class=search_results></div><script>let all_data=[];$.ajax({url:"/index/hayabusa_index.json"}).done(function(e){all_data=e,DrawResults(e)});function matchItem(e,t){if(t.title.toUpperCase().includes(e)||t.description.toUpperCase().includes(e))return!0;let n=t.tags||[];for(let t=0;t<n.length;t++)if(n[t].toUpperCase().includes(e))return!0;return!1}function doSearch(){let t=document.getElementById("myInput"),n=t.value.toUpperCase(),e=[];for(let t=0;t<all_data.length;t++){let s=all_data[t];if(matchItem(n,s)&&e.push(s),e.length>50)break}DrawResults(e)}function DrawResults(e){$(".search_results").empty();let t=e.length;t>50&&(t=50);for(let o=0;o<t;o++){let n=e[o],s=$(`
<div class="panel panel-default color">
  <div class="panel-heading color">
    <a class="title" target="new" href=""><h3 class="panel-title color " ></h3></a>
    <div class="author pull-right"></div>
  </div>
  <div class="panel-body color">
    <div class="border color">
       <div class="border color">
         <div class="idea-inner-text-main color">
           <p class="description "></p>
           <p class="idea-tag space"></p>
         </div>
       </div>
    </div>
</div>`);s.find(".title").append(n.title),s.find(".author").append(n.author),s.find(".description").append(n.description),s.find(".title").attr("href",n.link),s.find(".date").append(n.date);for(let e=0;e<n.tags.length;e++){let t=n.tags[e],o=$(`
<a class="space tag"><i class="linkcolour label label-success">`+t+`</i></a>`).click(function(){document.getElementById("myInput").value=t,doSearch()});s.find(".idea-tag").append(o)}let i=$(".search_results").append(s)}}function myFunction(){var e,n,s,o=document.getElementById("myInput"),i=o.value.toUpperCase(),a=document.getElementById("myUL"),t=a.getElementsByTagName("li");for(e=0;e<t.length;e++)n=t[e].getElementsByTagName("a")[0],s=n.textContent||n.innerText,s.toUpperCase().indexOf(i)>-1?t[e].style.display="":t[e].style.display="none"}</script></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#search-the-hayabusa-ruleset>Search the Hayabusa ruleset</a></li></ul></li></ul></nav></div></aside></main></body></html>